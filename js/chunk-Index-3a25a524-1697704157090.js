var Ie=Object.defineProperty;var Ce=(i,t,l)=>t in i?Ie(i,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[t]=l;var u=(i,t,l)=>(Ce(i,typeof t!="symbol"?t+"":t,l),l);import{d as Me,_ as ae,a as k}from"./index.js";import{g as Ue,b as Oe,u as c,w as De,B as L,y as N,t as te,E as Ae,e as me,p as Q,r as j,ac as de,o as v,c as S,a as w,_ as B,V as H,J as z,L as a,P as p,U as oe,C as Ye,S as fe,Q as P,q as Xe,H as qe,A as ne,M as J,ae as K,T as xe,R as je,an as _e,ao as he,v as we,$ as Be}from"./chunk-vue-f6e494cf-1697704157090.js";import{E as Se,f as C,g as M,h as U,j as O,k as A,l as ze,m as Fe,n as We,o as He,p as Ge,q as Ve}from"./chunk-element-plus-49e7b43c-1697704157090.js";function Ee(i){return Ue()?(Oe(i),!0):!1}function ve(i){return typeof i=="function"?i():c(i)}const Qe=typeof window<"u"&&typeof document<"u",Je=Object.prototype.toString,Ke=i=>Je.call(i)==="[object Object]",re=()=>{};function Ze(i,t){function l(...e){return new Promise((o,r)=>{Promise.resolve(i(()=>t.apply(this,e),{fn:t,thisArg:this,args:e})).then(o).catch(r)})}return l}function et(i,t=!0,l=!0,e=!1){let o=0,r,n=!0,s=re,f;const m=()=>{r&&(clearTimeout(r),r=void 0,s(),s=re)};return y=>{const h=ve(i),T=Date.now()-o,V=()=>f=y();return m(),h<=0?(o=Date.now(),V()):(T>h&&(l||!n)?(o=Date.now(),V()):t&&(f=new Promise(($,I)=>{s=e?I:$,r=setTimeout(()=>{o=Date.now(),n=!0,$(V()),m()},Math.max(0,h-T))})),!l&&!r&&(r=setTimeout(()=>n=!0,h)),n=!1,f)}}function tt(i,t=200,l=!1,e=!0,o=!1){return Ze(et(t,l,e,o),i)}function ot(i){var t;const l=ve(i);return(t=l==null?void 0:l.$el)!=null?t:l}const lt=Qe?window:void 0;function be(...i){let t,l,e,o;if(typeof i[0]=="string"||Array.isArray(i[0])?([l,e,o]=i,t=lt):[t,l,e,o]=i,!t)return re;Array.isArray(l)||(l=[l]),Array.isArray(e)||(e=[e]);const r=[],n=()=>{r.forEach(d=>d()),r.length=0},s=(d,y,h,T)=>(d.addEventListener(y,h,T),()=>d.removeEventListener(y,h,T)),f=De(()=>[ot(t),ve(o)],([d,y])=>{if(n(),!d)return;const h=Ke(y)?{...y}:y;r.push(...l.flatMap(T=>e.map(V=>s(d,T,V,h))))},{immediate:!0,flush:"post"}),m=()=>{f(),n()};return Ee(m),m}const E=Me({id:"flow",state:()=>({maybeNeedScrollParent:!1,dom:{elementNodeContainerDom:null},flowData:{canvasSize:{width:1920,height:1080},nodes:[],connections:[]},flowDomOffset:null,scrollDom:null,selectedLines:[],selectedElementNodes:[],hoverLine:null,validateResults:[]}),actions:{}});function at(i){return{all:i=i||new Map,on:function(t,l){var e=i.get(t);e?e.push(l):i.set(t,[l])},off:function(t,l){var e=i.get(t);e&&(l?e.splice(e.indexOf(l)>>>0,1):i.set(t,[]))},emit:function(t,l){var e=i.get(t);e&&e.slice().map(function(o){o(l)}),(e=i.get("*"))&&e.slice().map(function(o){o(t,l)})}}}const F=at();function Ne(){const i=[],t="0123456789abcdef";for(let e=0;e<36;e++)i[e]=t.at(Math.floor(Math.random()*16));return i[14]="4",i[19]=t.at(i[19]&3|8),i[8]=i[13]=i[18]=i[23]="-",i.join("")}function Z(i,t,l){function e(s){if(!s.on||typeof s.on!="function"){console.warn(`${s}上不存在on方法`);return}if(!s.off||typeof s.off!="function"){console.warn(`${s}上不存在off方法`);return}}let o=()=>{};const r=De(()=>c(i),s=>{o(),e(s),s.on(t,l),o=()=>{s.off(t,l),o=()=>{}}},{immediate:!0,flush:"post"}),n=()=>{r(),o(),console.count("停止监听次数：")};return Ee(n),n}const nt={class:"flex items-center h-40Px w-full"},st=L({__name:"Index",props:{data:{},title:{},controlPoint:{},formRef:{}},setup(i){var x,g;const{data:t,title:l,controlPoint:e,formRef:o}=i,r=N(),n=te("dragElementNodeService"),s=te("drawLineService"),f=te("editElementNodeService");(g=(x=t.additional).showDrop)!=null||(x.showDrop=!0);const m=Ae(t.additional,"showDrop"),d=N();me(()=>{const{height:b}=d.value.firstElementChild.getBoundingClientRect();d.value.style.setProperty("--height",`${b}px`),V.value=!m.value});const y=E(),h=Q(()=>y.selectedElementNodes.some(b=>b.id===t.id));function T(){m.value=!m.value,m.value&&(V.value=!1)}const V=j(!1);function $(){V.value=!m.value}const I=j(!0);return Z(F,"validate",()=>{o&&o.validate(b=>{I.value=b,y.validateResults.push(b)})}),(b,_)=>{const q=de("ArrowDown"),le=Se,ee=ae;return v(),S("div",{ref_key:"nodeRef",ref:r,style:fe({transform:`translate(${b.data.additional.layoutX}px, ${b.data.additional.layoutY}px)`}),class:z(["element-node absolute flex flex-col items-center w-280Px rounded-6Px",{selected:c(h),"validate-fail":!c(I)}]),onMousedown:_[9]||(_[9]=R=>c(n).onMouseDown(b.data,R,c(r)))},[w("header",nt,[b.controlPoint!=="right"?(v(),S("i",{key:0,class:"extend-area !absolute w-14Px h-14Px inline-block rounded-3Px cursor-pointer bg-#e0e0e0 -translate-x-1/2",border:"1Px solid #999",onMousedown:_[0]||(_[0]=B(R=>c(s).mouseDown("left",b.data,R),["stop"])),onMouseenter:_[1]||(_[1]=R=>c(s).mouseEnterConnector("left",b.data,R)),onMouseleave:_[2]||(_[2]=(...R)=>c(s).mouseLeaveConnector&&c(s).mouseLeaveConnector(...R))},null,32)):H("",!0),w("div",{class:z(["header-bar w-full flex items-center justify-between h-full rounded-t-6Px",{"rounded-b-6Px":c(V)}]),p:"x-20Px",text:"14Px center white"},[a(le,{class:"cursor-pointer",onClick:B(T,["prevent"]),onMousedown:_[3]||(_[3]=B(R=>c(n).setIndex(c(r)),["stop"]))},{default:p(()=>[a(q,{class:z(["arrow",{"-rotate-180":!c(m)}])},null,8,["class"])]),_:1},8,["onClick"]),w("span",null,oe(b.title),1),a(ee,{name:"close",class:"text-17Px cursor-pointer",onClick:_[4]||(_[4]=R=>c(f).remove(b.data)),onMousedown:_[5]||(_[5]=B(()=>{},["stop"]))})],2),b.controlPoint!=="left"?(v(),S("i",{key:1,class:"extend-area !absolute right-0 w-14Px h-14Px inline-block rounded-3Px cursor-pointer bg-#e0e0e0 translate-x-1/2",border:"1Px solid #999",onMousedown:_[6]||(_[6]=B(R=>c(s).mouseDown("right",b.data,R),["stop"])),onMouseenter:_[7]||(_[7]=R=>c(s).mouseEnterConnector("right",b.data,R)),onMouseleave:_[8]||(_[8]=(...R)=>c(s).mouseLeaveConnector&&c(s).mouseLeaveConnector(...R))},null,32)):H("",!0)]),w("footer",{ref_key:"dropRef",ref:d,class:z(["drop-content w-full overflow-hidden rounded-b-6Px",c(m)?"h-drop":"!h-0"]),onTransitionend:$},[Ye(b.$slots,"default",{},void 0,!0)],34)],38)}}});const X=k(st,[["__scopeId","data-v-97ffde04"]]),dt=L({__name:"Event2",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"事件节点2","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const rt=k(dt,[["__scopeId","data-v-91d33750"]]),it=L({__name:"Evnet3",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"条件节点3","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const pt=k(it,[["__scopeId","data-v-561304a9"]]),ct=L({__name:"Event4",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"事件节点4","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const ut=k(ct,[["__scopeId","data-v-7a19bc5f"]]),mt=L({__name:"Event5",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"事件节点5","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const ft=k(mt,[["__scopeId","data-v-613a4253"]]),_t=L({__name:"Event1",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"条件节点1","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const ht=k(_t,[["__scopeId","data-v-56ca2715"]]),vt=L({__name:"Middle1",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"中间节点1","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const gt=k(vt,[["__scopeId","data-v-c09fc3d1"]]),yt=L({__name:"Middle2",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"中间节点2","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const xt=k(yt,[["__scopeId","data-v-b403c414"]]),wt=L({__name:"Action2",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点2","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const bt=k(wt,[["__scopeId","data-v-cf742146"]]),Dt=L({__name:"Action1",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点1","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const St=k(Dt,[["__scopeId","data-v-9ed96ce1"]]),Vt=L({__name:"Action3",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点3","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const Et=k(Vt,[["__scopeId","data-v-735a9f0b"]]),Nt=L({__name:"Action4",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点4","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const Tt=k(Nt,[["__scopeId","data-v-d0a5538e"]]),Rt=L({__name:"Action5",props:{data:{}},setup(i){const t=N(),l={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,o)=>{const r=C,n=M,s=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点5","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:l,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":o[1]||(o[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(s,{label:"类型1",value:1}),a(s,{label:"类型2",value:2}),a(s,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(r,{modelValue:e.data.params.name,"onUpdate:modelValue":o[2]||(o[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const Pt=k(Rt,[["__scopeId","data-v-0d4217f1"]]),G={width:280,height:40},ge=`arrow${Math.random()*100}`,Te=`${ge}-selected`,Re="control-btn",Y={fromX:G.width,fromY:G.height/2,toX:0,toY:G.height/2};function Pe(i,t){return`M ${i.x} ${i.y}  C ${i.x}, ${i.y+(t.y-i.y)/2} ${t.x-50}, ${t.y-(t.y-i.y)/2} ${t.x} ${t.y}`}const ie=["eventNode1","eventNode3","middleNode1"],pe=[{icon:"event-1",title:"条件节点1",type:"eventNode1",component:ht},{icon:"event-2",title:"事件节点2",type:"eventNode2",component:rt},{icon:"event-3",title:"条件节点3",type:"eventNode3",component:pt},{icon:"event-4",title:"事件节点4",type:"eventNode4",component:ut},{icon:"event-5",title:"事件节点5",type:"eventNode5",component:ft}],ke=[{icon:"middle-1",title:"条件节点1",type:"middleNode1",component:gt},{icon:"middle-2",title:"中间节点2",type:"middleNode2",component:xt}],ce=[{icon:"action-1",title:"动作节点1",type:"actionNode1",component:St},{icon:"action-2",title:"动作节点2",type:"actionNode2",component:bt},{icon:"action-3",title:"动作节点3",type:"actionNode3",component:Et},{icon:"action-4",title:"动作节点4",type:"actionNode4",component:Tt},{icon:"action-5",title:"动作节点5",type:"actionNode5",component:Pt}],ue={TRUE:"满足",FALSE:"不满足"},Le={FIRST:"条件一",SECOND:"条件二",THIRD:"条件三"},kt=["d","marker-end","onClick"],Lt=L({__name:"ConnectLine",props:{allData:{},data:{}},setup(i){const{allData:t,data:l}=i,e=j();Xe(()=>{if(!t)return;const{fromId:y,toId:h}=l,T=t.nodes.find(g=>g.id===y),V=t.nodes.find(g=>g.id===h);if(!T||!V)return;const $=T.additional.layoutX+Y.fromX,I=T.additional.layoutY+Y.fromY,W=V.additional.layoutX+Y.toX,x=V.additional.layoutY+Y.toY;e.value=Pe({x:$,y:I},{x:W,y:x})});const o=E(),r=te("rectangleSelect"),n=Q(()=>o.selectedLines.some(y=>y.id===l.id));function s(){r.clear(),r.selectLine(l)}const f=Q(()=>{var y;return!n.value&&((y=o.hoverLine)==null?void 0:y.id)===l.id});function m(){o.hoverLine=l}function d(){o.hoverLine=null}return(y,h)=>y.data.hidden?H("",!0):(v(),S("path",{key:0,d:c(e),class:z(["line",[c(n)?"selected-line":"default-line",{hover:c(f)}]]),"marker-end":`url(#${c(n)?c(Te):c(ge)})`,onClick:B(s,["stop"]),onMouseenter:m,onMouseleave:d},null,42,kt))}});const $t=k(Lt,[["__scopeId","data-v-48a84d75"]]),It=["id","onClick"],Ct={key:0},Mt={key:1},Ut=L({__name:"Tag",props:{allData:{},data:{}},setup(i){const{allData:t,data:l}=i,e=N();let o=80,r=40;me(()=>{const{width:x,height:g}=e.value.getBoundingClientRect();o=x,r=g});const n=Q(()=>{const{fromId:x,toId:g}=l,b=t.nodes.find(D=>D.id===x),_=t.nodes.find(D=>D.id===g);if(!b||!_)return;const q=b.additional.layoutX+Y.fromX,le=b.additional.layoutY+Y.fromY,ee=_.additional.layoutX+Y.toX,R=_.additional.layoutY+Y.toY;return{x:(q+ee-o)/2,y:(le+R-r)/2}}),s=E(),f=te("rectangleSelect"),m=Q(()=>s.selectedLines.some(x=>x.id===l.id)),d=Q(()=>{var x;return!m.value&&((x=s.hoverLine)==null?void 0:x.id)===l.id});function y(){const x=t.connections.findIndex(g=>g.id===l.id);t.connections.splice(x,1)}const h=te("drawLineService");function T(){h.dialogState.visible=!0,h.isEditTag=!0,h.dialogState.data.type=l.type,h.curLine=l,h.getLinkTypeOp(W.value)}function V(){f.clear(),f.selectLine(l)}function $(){s.hoverLine=l}function I(){s.hoverLine=null}const W=Q(()=>t.nodes.find(x=>x.id===l.fromId));return(x,g)=>{const b=ae;return x.data.hidden?H("",!0):(v(),S("div",{key:0,id:x.data.id,ref_key:"rectRef",ref:e,class:z(["connect-tag absolute",{hover:c(d)}]),style:fe({top:`${c(n).y}px`,left:`${c(n).x}px`}),onClick:B(V,["stop"]),onMouseenter:$,onMouseleave:I},[x.data.type&&x.data.type!="TRUE"?(v(),S("div",{key:0,class:z([{selected:c(m)&&c(s).selectedElementNodes.length},"bg-white rounded-6Px"]),p:"y-7Px x-18Px",text:"12px",border:"2Px solid #ccc"},[c(ie).includes(c(W).type)?(v(),S("span",Ct,oe(c(Le)[x.data.type]),1)):(v(),S("span",Mt,oe(c(ue)[x.data.type]),1))],2)):H("",!0),c(m)&&!c(s).selectedElementNodes.length?(v(),S("div",{key:1,class:z([c(Re),"absolute top-0px right-0 -translate-y-full"]),text:"24Px"},[x.data.type&&x.data.type!="TRUE"?(v(),P(b,{key:0,name:"flow-edit",class:"mr-4Px cursor-pointer",onClick:T})):H("",!0),a(b,{name:"flow-delete",class:"cursor-pointer",onClick:y})],2)):H("",!0)],46,It))}}});const Ot=k(Ut,[["__scopeId","data-v-1203aa96"]]);class At{constructor(t,l,e){u(this,"flowDomOffset");u(this,"flowData");u(this,"flowRef");u(this,"add",t=>{t.preventDefault();const l=t.dataTransfer.getData("text/plain"),e=this.flowRef.value.parentElement;this.flowData.nodes.push({id:Ne(),type:l,params:{},additional:{layoutX:Math.floor(t.clientX-this.flowDomOffset.value.x-G.width/2+e.scrollLeft),layoutY:Math.floor(t.clientY-this.flowDomOffset.value.y-G.height/2+e.scrollTop)}})});u(this,"remove",t=>{const l=this.flowData,e=l.nodes.findIndex(o=>o.id===t.id);for(this.flowData.nodes.splice(e,1);l.connections.some(o=>o.fromId===t.id||o.toId===t.id);){const o=l.connections.findIndex(r=>r.fromId===t.id||r.toId===t.id);l.connections.splice(o,1)}});u(this,"dragOver",t=>{t.preventDefault(),t.dataTransfer.dropEffect="link"});this.flowDomOffset=t,this.flowData=l,this.flowRef=e}}class Yt{constructor(t){u(this,"curNode");u(this,"moveOffset",{x:0,y:0});u(this,"flowRef");u(this,"elementNodeDom");u(this,"preElementNodeDom");u(this,"onMouseDown",(t,l,e)=>{this.curNode=t;const{x:o,y:r}=e.getBoundingClientRect();this.moveOffset.x=l.x-o,this.moveOffset.y=l.y-r;const n=E();n.maybeNeedScrollParent=!0,this.setIndex(e)});u(this,"onMouseMove",t=>{if(F.emit("mouseMove",t),!this.curNode)return;const l=E(),e=l.scrollDom;let o=t.x-l.flowDomOffset.x-this.moveOffset.x+e.scrollLeft,r=t.y-l.flowDomOffset.y-this.moveOffset.y+e.scrollTop;o<0&&(o=0),r<0&&(r=0);let n=o-this.curNode.additional.layoutX,s=r-this.curNode.additional.layoutY;if(l.selectedElementNodes.length>1&&l.selectedElementNodes.some(f=>f.id===this.curNode.id)){const f=l.selectedElementNodes.some(d=>d.additional.layoutX+n<0),m=l.selectedElementNodes.some(d=>d.additional.layoutY+s<0);f&&(n=0),m&&(s=0),l.selectedElementNodes.forEach(d=>{d.additional.layoutX+=n,d.additional.layoutY+=s})}else this.curNode.additional.layoutX+=n,this.curNode.additional.layoutY+=s;this.extendCanvasSize({x:o,y:r})});u(this,"onMouseUp",t=>{F.emit("mouseUp",t);const l=E();l.maybeNeedScrollParent=!1,this.curNode=null,this.setPreDom()});u(this,"setIndex",t=>{this.preElementNodeDom&&(this.preElementNodeDom.style.zIndex="2"),this.elementNodeDom=t,t.style.zIndex="3"});u(this,"setPreDom",()=>{this.preElementNodeDom=this.elementNodeDom});u(this,"extendCanvasSize",t=>{const{width:l,height:e}=this.flowRef.value.getBoundingClientRect(),o=E();t.x>l-G.width&&(o.flowData.canvasSize.width+=500),t.y>e&&(o.flowData.canvasSize.height+=500)});this.flowRef=t}}class Xt{constructor(t,l,e,o){u(this,"isDrawing",!1);u(this,"startPointDom");u(this,"startPos",{x:0,y:0});u(this,"startPointType","");u(this,"startNode");u(this,"endNode",null);u(this,"isEditLine",!1);u(this,"isEditTag",!1);u(this,"curLine");u(this,"path");u(this,"flowSvgRef");u(this,"flowDomOffset");u(this,"flowData");u(this,"flowRef");u(this,"dialogState",qe({visible:!1,rules:{type:[{required:!0,message:"请选择类型",trigger:"blur"}]},data:{type:null},linkOp:ue}));u(this,"tempTagDom");u(this,"mouseDown",(t,l,e)=>{this.endNode=null,this.startPointDom=e.target,this.startPointDom.style.backgroundColor="#999999",this.isDrawing=!0,this.dialogState.data.type=null;const o=E();o.maybeNeedScrollParent=!0,this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.setAttribute("stroke","#808080"),this.path.setAttribute("stroke-width","4"),this.path.setAttribute("fill","transparent"),this.flowSvgRef.value.append(this.path);const r=this.flowRef.value.parentElement;if(t==="left"){const f=this.flowData.connections.filter(m=>m.toId===l.id);if(f.length){const m=f[Math.floor(Math.random()*f.length)];this.editLine(m);return}}this.isEditLine=!1,this.startNode=l,this.startPointType=t;const{x:n,y:s}=this.startPointDom.getBoundingClientRect();this.startPos.x=n+r.scrollLeft,this.startPos.y=s+r.scrollTop});u(this,"editLine",t=>{this.startPointType="right",this.isEditLine=!0,this.curLine=t,this.cancelSelect(t),this.addTempTag(t),this.startNode=this.flowData.nodes.find(e=>e.id===t.fromId),this.startPos.x=this.startNode.additional.layoutX+Y.fromX+this.flowDomOffset.value.x,this.startPos.y=this.startNode.additional.layoutY+Y.fromY+this.flowDomOffset.value.y;const l=this.flowData.nodes.find(e=>e.id===t.toId);this.setPath({x:l.additional.layoutX+this.flowDomOffset.value.x,y:l.additional.layoutY+Y.fromY+this.flowDomOffset.value.y}),t.hidden=!0});u(this,"cancelSelect",t=>{const e=E().selectedLines,o=e.findIndex(r=>r.id===t.id);o>-1&&e.splice(o,1)});u(this,"addTempTag",t=>{var n;(n=this.tempTagDom)==null||n.remove();const e=document.getElementById(t.id).cloneNode(!0),o=e.querySelector(`.${Re}`);o==null||o.remove(),e.id="tempTagDom",E().dom.elementNodeContainerDom.append(e),this.tempTagDom=e});u(this,"mouseMove",t=>{if(!this.isDrawing||this.endNode)return;const l=this.flowRef.value.parentElement,e={x:t.x+l.scrollLeft,y:t.y+l.scrollTop},o=this.setPath(e);this.isEditLine&&this.setTagPosition(o.from,o.to)});u(this,"setPath",t=>{const l=this.flowDomOffset,e=this.startPos.x-l.value.x,o=this.startPos.y-l.value.y;let r=t.x-l.value.x,n=t.y-l.value.y;r<0&&(r=0),n<0&&(n=0);const s=Pe({x:e,y:o},{x:r,y:n});return this.path.setAttribute("d",s),{from:{x:e,y:o},to:{x:r,y:n}}});u(this,"setTagPosition",(t,l)=>{const{width:e,height:o}=this.tempTagDom.getBoundingClientRect();this.tempTagDom.style.left=`${(t.x+l.x-e)/2}px`,this.tempTagDom.style.top=`${(t.y+l.y-o)/2}px`});u(this,"mouseEnterConnector",(t,l,e)=>{!this.isDrawing||this.startPointType=="left"||t===this.startPointType||this.startNode.id===l.id||this.flowData.connections.some(r=>[r.fromId,r.toId].every(n=>[this.startNode.id,l.id].includes(n)))||(this.endNode=l,this.setPath({x:l.additional.layoutX+this.flowDomOffset.value.x,y:l.additional.layoutY+Y.fromY+this.flowDomOffset.value.y}))});u(this,"mouseLeaveConnector",()=>{this.dialogState.visible||(this.endNode=null)});u(this,"mouseUp",()=>{if(!this.isDrawing)return;this.isDrawing=!1;const t=E();if(t.maybeNeedScrollParent=!1,this.startPointDom.style.backgroundColor="#E0E0E0",this.path.remove(),this.isEditLine&&(this.tempTagDom.remove(),this.tempTagDom=null),!this.endNode)this.isEditLine&&(this.curLine.hidden=!1);else if(this.isEditLine){const l=this.flowData.connections,e=l.findIndex(o=>o.id===this.curLine.id);l.splice(e,1),this.dialogState.data.type=this.curLine.type,this.add()}else ie.includes(this.startNode.type)?(this.getLinkTypeOp(this.startNode),this.dialogState.visible=!0,this.isEditTag=!1):(this.dialogState.data.type="TRUE",this.add())});u(this,"add",()=>{this.flowData.connections.push({fromId:this.startNode.id,toId:this.endNode.id,type:this.dialogState.data.type,id:Ne()})});u(this,"getLinkTypeOp",t=>{ie.includes(t.type)?this.dialogState.linkOp=Le:this.dialogState.linkOp=ue});this.flowSvgRef=t,this.flowDomOffset=l,this.flowData=e,this.flowRef=o,Z(F,"mouseMove",this.mouseMove),Z(F,"mouseUp",this.mouseUp)}}class qt{constructor(t){u(this,"flowRef");u(this,"edge",{top:0,left:0,bottom:0,right:0});u(this,"delta",10);u(this,"mouseMove",t=>{if(!E().maybeNeedScrollParent)return;const e=this.flowRef.value.parentElement,o=this.delta;t.x>this.edge.right?e.scrollLeft+=o:t.x<this.edge.left&&(e.scrollLeft-=o),t.y>this.edge.bottom?e.scrollTop+=o:t.y<this.edge.top&&(e.scrollTop-=o)});u(this,"getEdge",()=>{const t=Number.parseInt(getComputedStyle(document.documentElement).fontSize);this.edge.bottom=window.innerHeight-.5*t-20,this.edge.right=window.innerWidth-.5*t-20;const{x:l,y:e}=this.flowRef.value.getBoundingClientRect();this.edge.top=e+50,this.edge.left=l+50});this.flowRef=t,Z(F,"mouseMove",this.mouseMove)}}class jt{constructor(t,l){u(this,"visible",j(!1));u(this,"selectRect",{x1:0,y1:0,x2:0,y2:0});u(this,"selectElement");u(this,"flowData");u(this,"mouseDown",t=>{this.visible.value=!0;const l=this.getRelativePos(t);this.selectRect.x1=l.x,this.selectRect.y1=l.y,this.selectRect.x2=this.selectRect.x1,this.selectRect.y2=this.selectRect.y1,this.updateSelectRect();const e=E();e.maybeNeedScrollParent=!0});u(this,"mouseMove",t=>{if(!this.visible.value)return;const l=this.getRelativePos(t);this.selectRect.x2=l.x,this.selectRect.y2=l.y,this.updateSelectRect()});u(this,"mouseUp",t=>{if(!this.visible.value)return;this.visible.value=!1;const l=E();l.maybeNeedScrollParent=!1,this.selectElementNode()});u(this,"getRelativePos",t=>{const l=E(),e=l.flowDomOffset,o=l.scrollDom;return{x:t.x-e.x+o.scrollLeft,y:t.y-e.y+o.scrollTop}});u(this,"selectElementNode",()=>{this.clear();const t=E();for(const l of this.flowData.nodes){const{layoutX:e,layoutY:o}=l.additional,{x1:r,x2:n,y1:s,y2:f}=this.selectRect,m=Math.min(r,n),d=Math.max(r,n),y=Math.min(s,f),h=Math.max(s,f);e>m&&e+G.width<d&&o>y&&o+G.height<h&&t.selectedElementNodes.push(l)}for(const l of this.flowData.connections)t.selectedElementNodes.some(e=>e.id===l.fromId)&&t.selectedLines.push(l)});u(this,"selectLine",t=>{E().selectedLines.push(t)});u(this,"clear",()=>{const t=E();t.selectedLines=[],t.selectedElementNodes=[]});this.flowData=l,this.selectElement=t,Z(F,"mouseMove",this.mouseMove),Z(F,"mouseUp",this.mouseUp)}updateSelectRect(){const t=this.selectElement.value,{x1:l,x2:e,y1:o,y2:r}=this.selectRect,n=Math.min(l,e),s=Math.max(l,e),f=Math.min(o,r),m=Math.max(o,r);t.style.left=`${n}px`,t.style.top=`${f}px`,t.style.width=`${s-n}px`,t.style.height=`${m-f}px`}}const $e=i=>(_e("data-v-0dd7e4c5"),i=i(),he(),i),Bt=["id"],zt=$e(()=>w("polygon",{points:"-2,0 -5,5 5,0 -5,-5",stroke:"gray",fill:"gray","stroke-width":"1px"},null,-1)),Ft=[zt],Wt=["id"],Ht=$e(()=>w("polygon",{points:"-2,0 -5,5 5,0 -5,-5",stroke:"red",fill:"red","stroke-width":"1px"},null,-1)),Gt=[Ht],Qt={class:"flex justify-center pt-12px",border:"t-1px #ccc t-solid"},Jt=L({__name:"Index",setup(i){const t=E(),l=t.flowData,e=N(),o=N(),r=N(),n=j({x:0,y:0});function s(){const{x,y:g}=e.value.parentElement.getBoundingClientRect();n.value.x=x,n.value.y=g,t.flowDomOffset=n.value}me(()=>{s(),d.getEdge(),t.dom.elementNodeContainerDom=r.value,t.scrollDom=e.value.parentElement});const f=tt(()=>{s(),d.getEdge()},50);be("resize",f);const m=new Yt(e);ne("dragElementNodeService",m),be("mousemove",m.onMouseMove);const d=new qt(e),y=new At(n,l,e);ne("editElementNodeService",y);const h=new Xt(o,n,l,e);ne("drawLineService",h);function T(x){return[...pe,...ce,...ke].find(g=>x.type===g.type).component}const V=N(),$=new jt(V,l);ne("rectangleSelect",$),Z(F,"removeElementNodes",x=>{x.forEach(g=>y.remove(g)),$.clear()});const I=N();function W(){I.value.validate(x=>{x&&(h.isEditTag?h.curLine.type=h.dialogState.data.type:h.add(),h.dialogState.visible=!1)})}return(x,g)=>{const b=U,_=O,q=M,le=A,ee=ze,R=Fe;return v(),S("div",{ref_key:"flowRef",ref:e,class:"relative",style:fe({width:`${c(l).canvasSize.width}px`,height:`${c(l).canvasSize.height}px`}),onMousedown:g[6]||(g[6]=B((...D)=>c($).mouseDown&&c($).mouseDown(...D),["prevent"])),onMouseup:g[7]||(g[7]=(...D)=>c(m).onMouseUp&&c(m).onMouseUp(...D)),onDragover:g[8]||(g[8]=(...D)=>c(y).dragOver&&c(y).dragOver(...D)),onDrop:g[9]||(g[9]=(...D)=>c(y).add&&c(y).add(...D))},[(v(),S("svg",{id:"flowSvg",ref_key:"flowSvgRef",ref:o,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"100%",height:"100%",class:"relative z-1","data-spm-anchor-id":"TODO.11007039.0.i6.12b64a9bcbXQmm"},[w("defs",null,[w("marker",{id:c(ge),markerWidth:"5",markerHeight:"5",viewBox:"-6 -6 12 12",refX:"10",refY:"0",markerUnits:"strokeWidth",orient:"auto"},Ft,8,Bt),w("marker",{id:c(Te),markerWidth:"5",markerHeight:"5",viewBox:"-6 -6 12 12",refX:"10",refY:"0",markerUnits:"strokeWidth",orient:"auto"},Gt,8,Wt)]),w("g",null,[(v(!0),S(J,null,K(c(l).connections,D=>(v(),P($t,{key:D.id,"all-data":c(l),data:D,onMousedown:g[0]||(g[0]=B(()=>{},["stop"]))},null,8,["all-data","data"]))),128))])],512)),w("div",{ref_key:"elementNodeContainerRef",ref:r,class:"absolute inset-0 select-none overflow-hidden"},[(v(!0),S(J,null,K(c(l).nodes,D=>(v(),P(je(T(D)),{key:D.id,class:"z-2",data:D,onMousedown:g[1]||(g[1]=B(()=>{},["stop"]))},null,40,["data"]))),128)),(v(!0),S(J,null,K(c(l).connections,D=>(v(),P(Ot,{key:D.id,"all-data":c(l),data:D,class:"z-1",onMousedown:g[2]||(g[2]=B(()=>{},["stop"]))},null,8,["all-data","data"]))),128)),w("div",{ref_key:"selectElementRef",ref:V,class:z(["absolute z-3 bg-#147dff/10",{hidden:!c($).visible.value}]),border:"2px dashed #5262ff"},null,2)],512),a(R,{modelValue:c(h).dialogState.visible,"onUpdate:modelValue":g[5]||(g[5]=D=>c(h).dialogState.visible=D),title:"添加链接","align-center":"",width:"fit-content","destroy-on-close":""},{default:p(()=>[a(le,{ref_key:"dataFormRef",ref:I,model:c(h).dialogState.data,rules:c(h).dialogState.rules,"label-position":"right","label-width":"100px",class:"w-400px mx-50px"},{default:p(()=>[a(q,{label:"链接标签:",prop:"type"},{default:p(()=>[a(_,{modelValue:c(h).dialogState.data.type,"onUpdate:modelValue":g[3]||(g[3]=D=>c(h).dialogState.data.type=D),placeholder:"请选择"},{default:p(()=>[(v(!0),S(J,null,K(c(h).dialogState.linkOp,(D,ye)=>(v(),P(b,{key:ye,label:D,value:ye},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),w("div",Qt,[a(ee,{class:"w-80px",text:"",bg:"",onClick:g[4]||(g[4]=D=>c(h).dialogState.visible=!1)},{default:p(()=>[xe(" 取消")]),_:1}),a(ee,{type:"primary",class:"w-80px !ml-42px",onClick:W},{default:p(()=>[xe("确定")]),_:1})])]),_:1},8,["modelValue"])],36)}}});const Kt=k(Jt,[["__scopeId","data-v-0dd7e4c5"]]);const se=i=>(_e("data-v-579bac87"),i=i(),he(),i),Zt={class:"relative"},eo=["onDragstart"],to={class:"grid place-items-center w-40px bg-$event-node-color rounded-l-4px"},oo={class:"w-169px rounded-r-4px",border:"1px solid $event-node-color l-none"},lo=se(()=>w("i",{class:"absolute top-1/2 right-0 -translate-y-1/2 translate-x-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),ao=["onDragstart"],no={class:"rounded-l-4px ml-7px"},so={class:"grid place-items-center w-40px rounded-r-4px"},ro=se(()=>w("i",{class:"absolute top-1/2 -left-7px -translate-y-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),io=se(()=>w("i",{class:"absolute top-1/2 right-0 -translate-y-1/2 translate-x-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),po=["onDragstart"],co={class:"w-169px rounded-l-4px ml-7px",border:"1px solid $action-node-color r-none"},uo={class:"grid place-items-center w-40px bg-$action-node-color rounded-r-4px"},mo=se(()=>w("i",{class:"absolute top-1/2 left-0 -translate-y-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),fo=L({__name:"Left",setup(i){const t=j(["1","2","3"]),l=j(pe),e=j(ke),o=j(ce),r=j("");function n(){l.value=pe.filter(y=>y.title.toLowerCase().includes(r.value.toLowerCase())),o.value=ce.filter(y=>y.title.toLowerCase().includes(r.value.toLowerCase()))}function s(y,h){h.dataTransfer.setData("text/plain",y.type)}const f=j(!0);function m(){f.value=!f.value}function d(){const y=new Event("resize");window.dispatchEvent(y)}return(y,h)=>{const T=C,V=ae,$=We,I=He,W=Ge,x=de("ArrowLeftBold"),g=Se,b=de("ArrowRightBold");return v(),S("div",Zt,[w("div",{class:z(["node-container overflow-hidden",c(f)?"w-261px":"w-0"]),onTransitionend:d},[a(T,{modelValue:c(r),"onUpdate:modelValue":h[0]||(h[0]=_=>we(r)?r.value=_:null),modelModifiers:{trim:!0},clearable:"",placeholder:"查找节点","prefix-icon":"Search",maxlength:"60",class:"mb-12px pt-26px pl-26px pr-20px",onInput:n},null,8,["modelValue"]),a(W,{"max-height":"calc(100vh - 6rem)",class:"pl-26px pr-20px"},{default:p(()=>[a(I,{modelValue:c(t),"onUpdate:modelValue":h[1]||(h[1]=_=>we(t)?t.value=_:null),class:"select-none"},{default:p(()=>[a($,{title:"事件节点",name:"1"},{default:p(()=>[(v(!0),S(J,null,K(c(l),_=>(v(),S("div",{key:_.icon,class:"relative flex w-199px h-40px leading-40px mb-12px",text:"#333 center",draggable:"true",onDragstart:q=>s(_,q)},[w("div",to,[a(V,{name:_.icon,class:"text-22px text-white"},null,8,["name"])]),w("div",oo,oe(_.title),1),lo],40,eo))),128))]),_:1}),a($,{title:"中间节点",name:"2"},{default:p(()=>[(v(!0),S(J,null,K(c(e),_=>(v(),S("div",{key:_.icon,class:"relative flex justify-center w-199px h-40px leading-40px mb-12px ml-7px bg-#22d3ee rounded-4px",text:"white center",draggable:"true",onDragstart:q=>s(_,q)},[w("div",no,oe(_.title),1),w("div",so,[a(V,{name:_.icon,class:"text-22px"},null,8,["name"])]),ro,io],40,ao))),128))]),_:1}),a($,{title:"动作节点",name:"3"},{default:p(()=>[(v(!0),S(J,null,K(c(o),_=>(v(),S("div",{key:_.icon,class:"relative flex w-199px h-40px leading-40px mb-12px",text:"#333 center",draggable:"true",onDragstart:q=>s(_,q)},[w("div",co,oe(_.title),1),w("div",uo,[a(V,{name:_.icon,class:"text-22px text-white"},null,8,["name"])]),mo],40,po))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})],34),w("div",{class:"absolute top-66px right-0 translate-x-full z-9 grid place-items-center w-13px h-44px rounded-r-6px bg-#D8D8D8 cursor-pointer",text:"14px white",hover:"bg-#8c8c8c",onClick:m},[c(f)?(v(),P(g,{key:0},{default:p(()=>[a(x)]),_:1})):(v(),P(g,{key:1},{default:p(()=>[a(b)]),_:1}))])])}}});const _o=k(fo,[["__scopeId","data-v-579bac87"]]),ho={class:"absolute z-2 bottom-30px right-30px flex gap-x-30px",text:"38px"},vo={key:0},go={class:"grid place-items-center w-38px h-38px rounded-1/2 bg-red cursor-pointer"},yo=L({__name:"Right",setup(i){const t=E();function l(){F.emit("removeElementNodes",t.selectedElementNodes)}return(e,o)=>{const r=ae,n=Ve;return v(),S("div",ho,[a(Be,{name:"slide-up1",appear:""},{default:p(()=>[c(t).selectedElementNodes.length?(v(),S("div",vo,[a(n,{content:"删除选中节点和连接"},{default:p(()=>[w("div",go,[a(r,{name:"delete",class:"text-20px text-white",onClick:l})])]),_:1})])):H("",!0)]),_:1})])}}});const xo=k(yo,[["__scopeId","data-v-e2a7d762"]]),wo=i=>(_e("data-v-c977e25c"),i=i(),he(),i),bo={class:"flex h-screen"},Do={class:"grow flex flex-col overflow-hidden"},So={class:"flex items-center justify-between h-50px",p:"x-25px",border:"b-1px #ccc b-solid"},Vo=wo(()=>w("div",{class:"font-bold tracking-3px"},"流程图绘制",-1)),Eo={href:"https://github.com/Fate-ui/flowChart",class:"text-black",target:"_blank"},No={class:"grow relative"},To={class:"absolute inset-0 overflow-scroll ml-8px mt-8px scroller"},Ro=L({__name:"Index",setup(i){return(t,l)=>{const e=ae,o=Ve;return v(),S("div",bo,[a(_o,{class:"shrink-0",border:"r-1px r-solid #ccc"}),w("section",Do,[w("header",So,[Vo,a(o,{content:"GitHub"},{default:p(()=>[w("a",Eo,[a(e,{name:"flow-list",class:"text-32px shrink-0 cursor-pointer"})])]),_:1})]),w("div",No,[w("div",To,[a(Kt)]),a(xo)])])])}}});const Io=k(Ro,[["__scopeId","data-v-c977e25c"]]);export{Io as default};
//# sourceMappingURL=chunk-Index-3a25a524-1697704157090.js.map
