var $e=Object.defineProperty;var Ce=(i,t,o)=>t in i?$e(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o;var u=(i,t,o)=>(Ce(i,typeof t!="symbol"?t+"":t,o),o);import{d as Me,_ as ae,a as k}from"./index.js";import{g as Ue,b as Oe,u as c,w as me,B as I,y as N,t as te,E as Ae,e as fe,p as G,r as j,ac as de,o as v,c as S,a as x,_ as B,V as H,J as z,L as a,P as p,U as oe,C as Ye,S as _e,Q as P,q as Xe,H as qe,A as ne,M as Q,ae as K,T as xe,R as je,an as he,ao as ve,v as be,$ as Be,a9 as ze}from"./chunk-vue-f6e494cf-1700555262641.js";import{E as Se,f as C,g as M,h as U,j as O,k as A,l as Fe,m as We,n as He,o as Je,p as Ge,q as Ee}from"./chunk-element-plus-37007acc-1700555262641.js";function Ve(i){return Ue()?(Oe(i),!0):!1}function ge(i){return typeof i=="function"?i():c(i)}const Qe=typeof window<"u"&&typeof document<"u",Ke=Object.prototype.toString,Ze=i=>Ke.call(i)==="[object Object]",re=()=>{};function et(i,t){function o(...e){return new Promise((l,s)=>{Promise.resolve(i(()=>t.apply(this,e),{fn:t,thisArg:this,args:e})).then(l).catch(s)})}return o}function tt(i,t=!0,o=!0,e=!1){let l=0,s,n=!0,d=re,f;const m=()=>{s&&(clearTimeout(s),s=void 0,d(),d=re)};return y=>{const h=ge(i),T=Date.now()-l,E=()=>f=y();return m(),h<=0?(l=Date.now(),E()):(T>h&&(o||!n)?(l=Date.now(),E()):t&&(f=new Promise((L,$)=>{d=e?$:L,s=setTimeout(()=>{l=Date.now(),n=!0,L(E()),m()},Math.max(0,h-T))})),!o&&!s&&(s=setTimeout(()=>n=!0,h)),n=!1,f)}}function ot(i,t=200,o=!1,e=!0,l=!1){return et(tt(t,o,e,l),i)}function lt(i){var t;const o=ge(i);return(t=o==null?void 0:o.$el)!=null?t:o}const at=Qe?window:void 0;function De(...i){let t,o,e,l;if(typeof i[0]=="string"||Array.isArray(i[0])?([o,e,l]=i,t=at):[t,o,e,l]=i,!t)return re;Array.isArray(o)||(o=[o]),Array.isArray(e)||(e=[e]);const s=[],n=()=>{s.forEach(r=>r()),s.length=0},d=(r,y,h,T)=>(r.addEventListener(y,h,T),()=>r.removeEventListener(y,h,T)),f=me(()=>[lt(t),ge(l)],([r,y])=>{if(n(),!r)return;const h=Ze(y)?{...y}:y;s.push(...o.flatMap(T=>e.map(E=>d(r,T,E,h))))},{immediate:!0,flush:"post"}),m=()=>{f(),n()};return Ve(m),m}const nt={canvasSize:{width:1920,height:1080},nodes:[{id:"b8311a00-7202-445d-8758-6a60df5403a3",type:"middleNode2",params:{},additional:{layoutX:450,layoutY:293,showDrop:!1}},{id:"8eae56e7-6f42-441e-87e5-ff9731fd94cb",type:"actionNode1",params:{name:"test",eventType:2},additional:{layoutX:770,layoutY:444,showDrop:!0}},{id:"6bba2281-d768-4b54-9010-954ab077ba55",type:"eventNode1",params:{},additional:{layoutX:35,layoutY:161,showDrop:!1}}],connections:[{fromId:"6bba2281-d768-4b54-9010-954ab077ba55",toId:"b8311a00-7202-445d-8758-6a60df5403a3",type:"SECOND",id:"1f1a741c-9236-4883-89f4-38b1b226f208"},{fromId:"b8311a00-7202-445d-8758-6a60df5403a3",toId:"8eae56e7-6f42-441e-87e5-ff9731fd94cb",type:"TRUE",id:"96e4e78e-64dc-497d-8b3d-6465653dc376"}]},V=Me({id:"flow",state:()=>({maybeNeedScrollParent:!1,dom:{elementNodeContainerDom:null},flowData:{canvasSize:{width:1920,height:1080},nodes:[],connections:[]},flowDomOffset:null,scrollDom:null,selectedLines:[],selectedElementNodes:[],hoverLine:null,validateResults:[]}),actions:{}});function st(i){return{all:i=i||new Map,on:function(t,o){var e=i.get(t);e?e.push(o):i.set(t,[o])},off:function(t,o){var e=i.get(t);e&&(o?e.splice(e.indexOf(o)>>>0,1):i.set(t,[]))},emit:function(t,o){var e=i.get(t);e&&e.slice().map(function(l){l(o)}),(e=i.get("*"))&&e.slice().map(function(l){l(t,o)})}}}const F=st();function Ne(){const i=[],t="0123456789abcdef";for(let e=0;e<36;e++)i[e]=t.at(Math.floor(Math.random()*16));return i[14]="4",i[19]=t.at(i[19]&3|8),i[8]=i[13]=i[18]=i[23]="-",i.join("")}function Z(i,t,o){function e(d){if(!d.on||typeof d.on!="function"){console.warn(`${d}上不存在on方法`);return}if(!d.off||typeof d.off!="function"){console.warn(`${d}上不存在off方法`);return}}let l=()=>{};const s=me(()=>c(i),d=>{l(),e(d),d.on(t,o),l=()=>{d.off(t,o),l=()=>{}}},{immediate:!0,flush:"post"}),n=()=>{s(),l()};return Ve(n),n}const dt={class:"flex items-center h-40Px w-full"},rt=I({__name:"Index",props:{data:{},title:{},controlPoint:{},formRef:{}},setup(i){var w,g;const{data:t,title:o,controlPoint:e,formRef:l}=i,s=N(),n=te("dragElementNodeService"),d=te("drawLineService"),f=te("editElementNodeService");(g=(w=t.additional).showDrop)!=null||(w.showDrop=!0);const m=Ae(t.additional,"showDrop"),r=N();fe(()=>{const{height:b}=r.value.firstElementChild.getBoundingClientRect();r.value.style.setProperty("--height",`${b}px`),E.value=!m.value});const y=V(),h=G(()=>y.selectedElementNodes.some(b=>b.id===t.id));function T(){m.value=!m.value,m.value&&(E.value=!1)}const E=j(!1);function L(){E.value=!m.value}const $=j(!0);return Z(F,"validate",()=>{l&&l.validate(b=>{$.value=b,y.validateResults.push(b)})}),(b,_)=>{const q=de("ArrowDown"),le=Se,ee=ae;return v(),S("div",{ref_key:"nodeRef",ref:s,style:_e({transform:`translate(${b.data.additional.layoutX}px, ${b.data.additional.layoutY}px)`}),class:z(["element-node absolute flex flex-col items-center w-280Px rounded-6Px",{selected:c(h),"validate-fail":!c($)}]),onMousedown:_[9]||(_[9]=R=>c(n).onMouseDown(b.data,R,c(s)))},[x("header",dt,[b.controlPoint!=="right"?(v(),S("i",{key:0,class:"extend-area !absolute w-14Px h-14Px inline-block rounded-3Px cursor-pointer bg-#e0e0e0 -translate-x-1/2",border:"1Px solid #999",onMousedown:_[0]||(_[0]=B(R=>c(d).mouseDown("left",b.data,R),["stop"])),onMouseenter:_[1]||(_[1]=R=>c(d).mouseEnterConnector("left",b.data,R)),onMouseleave:_[2]||(_[2]=(...R)=>c(d).mouseLeaveConnector&&c(d).mouseLeaveConnector(...R))},null,32)):H("",!0),x("div",{class:z(["header-bar w-full flex items-center justify-between h-full rounded-t-6Px",{"rounded-b-6Px":c(E)}]),p:"x-20Px",text:"14Px center white"},[a(le,{class:"cursor-pointer",onClick:B(T,["prevent"]),onMousedown:_[3]||(_[3]=B(R=>c(n).setIndex(c(s)),["stop"]))},{default:p(()=>[a(q,{class:z(["arrow",{"-rotate-180":!c(m)}])},null,8,["class"])]),_:1},8,["onClick"]),x("span",null,oe(b.title),1),a(ee,{name:"close",class:"text-17Px cursor-pointer",onClick:_[4]||(_[4]=R=>c(f).remove(b.data)),onMousedown:_[5]||(_[5]=B(()=>{},["stop"]))})],2),b.controlPoint!=="left"?(v(),S("i",{key:1,class:"extend-area !absolute right-0 w-14Px h-14Px inline-block rounded-3Px cursor-pointer bg-#e0e0e0 translate-x-1/2",border:"1Px solid #999",onMousedown:_[6]||(_[6]=B(R=>c(d).mouseDown("right",b.data,R),["stop"])),onMouseenter:_[7]||(_[7]=R=>c(d).mouseEnterConnector("right",b.data,R)),onMouseleave:_[8]||(_[8]=(...R)=>c(d).mouseLeaveConnector&&c(d).mouseLeaveConnector(...R))},null,32)):H("",!0)]),x("footer",{ref_key:"dropRef",ref:r,class:z(["drop-content w-full overflow-hidden rounded-b-6Px",c(m)?"h-drop":"!h-0"]),onTransitionend:L},[Ye(b.$slots,"default",{},void 0,!0)],34)],38)}}});const X=k(rt,[["__scopeId","data-v-97ffde04"]]),it=I({__name:"Event2",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"事件节点2","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const pt=k(it,[["__scopeId","data-v-91d33750"]]),ct=I({__name:"Evnet3",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"条件节点3","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const ut=k(ct,[["__scopeId","data-v-561304a9"]]),mt=I({__name:"Event4",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"事件节点4","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const ft=k(mt,[["__scopeId","data-v-7a19bc5f"]]),_t=I({__name:"Event5",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"事件节点5","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const ht=k(_t,[["__scopeId","data-v-613a4253"]]),vt=I({__name:"Event1",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"条件节点1","control-point":"right","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const gt=k(vt,[["__scopeId","data-v-56ca2715"]]),yt=I({__name:"Middle1",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"中间节点1","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const wt=k(yt,[["__scopeId","data-v-c09fc3d1"]]),xt=I({__name:"Middle2",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"中间节点2","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const bt=k(xt,[["__scopeId","data-v-b403c414"]]),Dt=I({__name:"Action2",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点2","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const St=k(Dt,[["__scopeId","data-v-cf742146"]]),Et=I({__name:"Action1",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点1","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const Vt=k(Et,[["__scopeId","data-v-9ed96ce1"]]),Nt=I({__name:"Action3",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点3","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const Tt=k(Nt,[["__scopeId","data-v-735a9f0b"]]),Rt=I({__name:"Action4",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点4","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const Pt=k(Rt,[["__scopeId","data-v-d0a5538e"]]),kt=I({__name:"Action5",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,l)=>{const s=C,n=M,d=U,f=O,m=A;return v(),P(X,{data:e.data,title:"动作节点5","control-point":"left","form-ref":c(t)},{default:p(()=>[a(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[a(n,{label:"字段1",prop:"name"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(n,{label:"字段2",prop:"eventType"},{default:p(()=>[a(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":l[1]||(l[1]=r=>e.data.params.eventType=r),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[a(d,{label:"类型1",value:1}),a(d,{label:"类型2",value:2}),a(d,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段3"},{default:p(()=>[a(s,{modelValue:e.data.params.name,"onUpdate:modelValue":l[2]||(l[2]=r=>e.data.params.name=r),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}});const It=k(kt,[["__scopeId","data-v-0d4217f1"]]),J={width:280,height:40},ye=`arrow${Math.random()*100}`,Te=`${ye}-selected`,Re="control-btn",Y={fromX:J.width,fromY:J.height/2,toX:0,toY:J.height/2};function Pe(i,t){return`M ${i.x} ${i.y}  C ${i.x}, ${i.y+(t.y-i.y)/2} ${t.x-50}, ${t.y-(t.y-i.y)/2} ${t.x} ${t.y}`}const ie=["eventNode1","eventNode3","middleNode1"],pe=[{icon:"event-1",title:"条件节点1",type:"eventNode1",component:gt},{icon:"event-2",title:"事件节点2",type:"eventNode2",component:pt},{icon:"event-3",title:"条件节点3",type:"eventNode3",component:ut},{icon:"event-4",title:"事件节点4",type:"eventNode4",component:ft},{icon:"event-5",title:"事件节点5",type:"eventNode5",component:ht}],ke=[{icon:"middle-1",title:"条件节点1",type:"middleNode1",component:wt},{icon:"middle-2",title:"中间节点2",type:"middleNode2",component:bt}],ce=[{icon:"action-1",title:"动作节点1",type:"actionNode1",component:Vt},{icon:"action-2",title:"动作节点2",type:"actionNode2",component:St},{icon:"action-3",title:"动作节点3",type:"actionNode3",component:Tt},{icon:"action-4",title:"动作节点4",type:"actionNode4",component:Pt},{icon:"action-5",title:"动作节点5",type:"actionNode5",component:It}],ue={TRUE:"满足",FALSE:"不满足"},Ie={FIRST:"条件一",SECOND:"条件二",THIRD:"条件三"},Lt=["d","marker-end","onClick"],$t=I({__name:"ConnectLine",props:{allData:{},data:{}},setup(i){const{allData:t,data:o}=i,e=j();Xe(()=>{if(!t)return;const{fromId:y,toId:h}=o,T=t.nodes.find(g=>g.id===y),E=t.nodes.find(g=>g.id===h);if(!T||!E)return;const L=T.additional.layoutX+Y.fromX,$=T.additional.layoutY+Y.fromY,W=E.additional.layoutX+Y.toX,w=E.additional.layoutY+Y.toY;e.value=Pe({x:L,y:$},{x:W,y:w})});const l=V(),s=te("rectangleSelect"),n=G(()=>l.selectedLines.some(y=>y.id===o.id));function d(){s.clear(),s.selectLine(o)}const f=G(()=>{var y;return!n.value&&((y=l.hoverLine)==null?void 0:y.id)===o.id});function m(){l.hoverLine=o}function r(){l.hoverLine=null}return(y,h)=>y.data.hidden?H("",!0):(v(),S("path",{key:0,d:c(e),class:z(["line",[c(n)?"selected-line":"default-line",{hover:c(f)}]]),"marker-end":`url(#${c(n)?c(Te):c(ye)})`,onClick:B(d,["stop"]),onMouseenter:m,onMouseleave:r},null,42,Lt))}});const Ct=k($t,[["__scopeId","data-v-48a84d75"]]),Mt=["id","onClick"],Ut={key:0},Ot={key:1},At=I({__name:"Tag",props:{allData:{},data:{}},setup(i){const{allData:t,data:o}=i,e=N();let l=80,s=40;fe(()=>{const{width:w,height:g}=e.value.getBoundingClientRect();l=w,s=g});const n=G(()=>{const{fromId:w,toId:g}=o,b=t.nodes.find(D=>D.id===w),_=t.nodes.find(D=>D.id===g);if(!b||!_)return;const q=b.additional.layoutX+Y.fromX,le=b.additional.layoutY+Y.fromY,ee=_.additional.layoutX+Y.toX,R=_.additional.layoutY+Y.toY;return{x:(q+ee-l)/2,y:(le+R-s)/2}}),d=V(),f=te("rectangleSelect"),m=G(()=>d.selectedLines.some(w=>w.id===o.id)),r=G(()=>{var w;return!m.value&&((w=d.hoverLine)==null?void 0:w.id)===o.id});function y(){const w=t.connections.findIndex(g=>g.id===o.id);t.connections.splice(w,1)}const h=te("drawLineService");function T(){h.dialogState.visible=!0,h.isEditTag=!0,h.dialogState.data.type=o.type,h.curLine=o,h.getLinkTypeOp(W.value)}function E(){f.clear(),f.selectLine(o)}function L(){d.hoverLine=o}function $(){d.hoverLine=null}const W=G(()=>t.nodes.find(w=>w.id===o.fromId));return(w,g)=>{const b=ae;return w.data.hidden?H("",!0):(v(),S("div",{key:0,id:w.data.id,ref_key:"rectRef",ref:e,class:z(["connect-tag absolute",{hover:c(r)}]),style:_e({top:`${c(n).y}px`,left:`${c(n).x}px`}),onClick:B(E,["stop"]),onMouseenter:L,onMouseleave:$},[w.data.type&&w.data.type!="TRUE"?(v(),S("div",{key:0,class:z([{selected:c(m)&&c(d).selectedElementNodes.length},"bg-white rounded-6Px"]),p:"y-7Px x-18Px",text:"12px",border:"2Px solid #ccc"},[c(ie).includes(c(W).type)?(v(),S("span",Ut,oe(c(Ie)[w.data.type]),1)):(v(),S("span",Ot,oe(c(ue)[w.data.type]),1))],2)):H("",!0),c(m)&&!c(d).selectedElementNodes.length?(v(),S("div",{key:1,class:z([c(Re),"absolute top-0px right-0 -translate-y-full"]),text:"24Px"},[w.data.type&&w.data.type!="TRUE"?(v(),P(b,{key:0,name:"flow-edit",class:"mr-4Px cursor-pointer",onClick:T})):H("",!0),a(b,{name:"flow-delete",class:"cursor-pointer",onClick:y})],2)):H("",!0)],46,Mt))}}});const Yt=k(At,[["__scopeId","data-v-1203aa96"]]);class Xt{constructor(t,o,e){u(this,"flowDomOffset");u(this,"flowData");u(this,"flowRef");u(this,"add",t=>{t.preventDefault();const o=t.dataTransfer.getData("text/plain"),e=this.flowRef.value.parentElement;this.flowData.nodes.push({id:Ne(),type:o,params:{},additional:{layoutX:Math.floor(t.clientX-this.flowDomOffset.value.x-J.width/2+e.scrollLeft),layoutY:Math.floor(t.clientY-this.flowDomOffset.value.y-J.height/2+e.scrollTop)}})});u(this,"remove",t=>{const o=this.flowData,e=o.nodes.findIndex(l=>l.id===t.id);for(this.flowData.nodes.splice(e,1);o.connections.some(l=>l.fromId===t.id||l.toId===t.id);){const l=o.connections.findIndex(s=>s.fromId===t.id||s.toId===t.id);o.connections.splice(l,1)}});u(this,"dragOver",t=>{t.preventDefault(),t.dataTransfer.dropEffect="link"});this.flowDomOffset=t,this.flowData=o,this.flowRef=e}}class qt{constructor(t){u(this,"curNode");u(this,"moveOffset",{x:0,y:0});u(this,"flowRef");u(this,"elementNodeDom");u(this,"preElementNodeDom");u(this,"onMouseDown",(t,o,e)=>{this.curNode=t;const{x:l,y:s}=e.getBoundingClientRect();this.moveOffset.x=o.x-l,this.moveOffset.y=o.y-s;const n=V();n.maybeNeedScrollParent=!0,this.setIndex(e)});u(this,"onMouseMove",t=>{if(F.emit("mouseMove",t),!this.curNode)return;const o=V(),e=o.scrollDom;let l=t.x-o.flowDomOffset.x-this.moveOffset.x+e.scrollLeft,s=t.y-o.flowDomOffset.y-this.moveOffset.y+e.scrollTop;l<0&&(l=0),s<0&&(s=0);let n=l-this.curNode.additional.layoutX,d=s-this.curNode.additional.layoutY;if(o.selectedElementNodes.length>1&&o.selectedElementNodes.some(f=>f.id===this.curNode.id)){const f=o.selectedElementNodes.some(r=>r.additional.layoutX+n<0),m=o.selectedElementNodes.some(r=>r.additional.layoutY+d<0);f&&(n=0),m&&(d=0),o.selectedElementNodes.forEach(r=>{r.additional.layoutX+=n,r.additional.layoutY+=d})}else this.curNode.additional.layoutX+=n,this.curNode.additional.layoutY+=d;this.extendCanvasSize({x:l,y:s})});u(this,"onMouseUp",t=>{F.emit("mouseUp",t);const o=V();o.maybeNeedScrollParent=!1,this.curNode=null,this.setPreDom()});u(this,"setIndex",t=>{this.preElementNodeDom&&(this.preElementNodeDom.style.zIndex="2"),this.elementNodeDom=t,t.style.zIndex="3"});u(this,"setPreDom",()=>{this.preElementNodeDom=this.elementNodeDom});u(this,"extendCanvasSize",t=>{const{width:o,height:e}=this.flowRef.value.getBoundingClientRect(),l=V();t.x>o-J.width&&(l.flowData.canvasSize.width+=500),t.y>e&&(l.flowData.canvasSize.height+=500)});this.flowRef=t}}class jt{constructor(t,o,e,l){u(this,"isDrawing",!1);u(this,"startPointDom");u(this,"startPos",{x:0,y:0});u(this,"startPointType","");u(this,"startNode");u(this,"endNode",null);u(this,"isEditLine",!1);u(this,"isEditTag",!1);u(this,"curLine");u(this,"path");u(this,"flowSvgRef");u(this,"flowDomOffset");u(this,"flowData");u(this,"flowRef");u(this,"dialogState",qe({visible:!1,rules:{type:[{required:!0,message:"请选择类型",trigger:"blur"}]},data:{type:null},linkOp:ue}));u(this,"tempTagDom");u(this,"mouseDown",(t,o,e)=>{this.endNode=null,this.startPointDom=e.target,this.startPointDom.style.backgroundColor="#999999",this.isDrawing=!0,this.dialogState.data.type=null;const l=V();l.maybeNeedScrollParent=!0,this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.setAttribute("stroke","#808080"),this.path.setAttribute("stroke-width","4"),this.path.setAttribute("fill","transparent"),this.flowSvgRef.value.append(this.path);const s=this.flowRef.value.parentElement;if(t==="left"){const f=this.flowData.connections.filter(m=>m.toId===o.id);if(f.length){const m=f[Math.floor(Math.random()*f.length)];this.editLine(m);return}}this.isEditLine=!1,this.startNode=o,this.startPointType=t;const{x:n,y:d}=this.startPointDom.getBoundingClientRect();this.startPos.x=n+s.scrollLeft,this.startPos.y=d+s.scrollTop});u(this,"editLine",t=>{this.startPointType="right",this.isEditLine=!0,this.curLine=t,this.cancelSelect(t),this.addTempTag(t),this.startNode=this.flowData.nodes.find(e=>e.id===t.fromId),this.startPos.x=this.startNode.additional.layoutX+Y.fromX+this.flowDomOffset.value.x,this.startPos.y=this.startNode.additional.layoutY+Y.fromY+this.flowDomOffset.value.y;const o=this.flowData.nodes.find(e=>e.id===t.toId);this.setPath({x:o.additional.layoutX+this.flowDomOffset.value.x,y:o.additional.layoutY+Y.fromY+this.flowDomOffset.value.y}),t.hidden=!0});u(this,"cancelSelect",t=>{const e=V().selectedLines,l=e.findIndex(s=>s.id===t.id);l>-1&&e.splice(l,1)});u(this,"addTempTag",t=>{var n;(n=this.tempTagDom)==null||n.remove();const e=document.getElementById(t.id).cloneNode(!0),l=e.querySelector(`.${Re}`);l==null||l.remove(),e.id="tempTagDom",V().dom.elementNodeContainerDom.append(e),this.tempTagDom=e});u(this,"mouseMove",t=>{if(!this.isDrawing||this.endNode)return;const o=this.flowRef.value.parentElement,e={x:t.x+o.scrollLeft,y:t.y+o.scrollTop},l=this.setPath(e);this.isEditLine&&this.setTagPosition(l.from,l.to)});u(this,"setPath",t=>{const o=this.flowDomOffset,e=this.startPos.x-o.value.x,l=this.startPos.y-o.value.y;let s=t.x-o.value.x,n=t.y-o.value.y;s<0&&(s=0),n<0&&(n=0);const d=Pe({x:e,y:l},{x:s,y:n});return this.path.setAttribute("d",d),{from:{x:e,y:l},to:{x:s,y:n}}});u(this,"setTagPosition",(t,o)=>{const{width:e,height:l}=this.tempTagDom.getBoundingClientRect();this.tempTagDom.style.left=`${(t.x+o.x-e)/2}px`,this.tempTagDom.style.top=`${(t.y+o.y-l)/2}px`});u(this,"mouseEnterConnector",(t,o,e)=>{!this.isDrawing||this.startPointType=="left"||t===this.startPointType||this.startNode.id===o.id||this.flowData.connections.some(s=>[s.fromId,s.toId].every(n=>[this.startNode.id,o.id].includes(n)))||(this.endNode=o,this.setPath({x:o.additional.layoutX+this.flowDomOffset.value.x,y:o.additional.layoutY+Y.fromY+this.flowDomOffset.value.y}))});u(this,"mouseLeaveConnector",()=>{this.dialogState.visible||(this.endNode=null)});u(this,"mouseUp",()=>{if(!this.isDrawing)return;this.isDrawing=!1;const t=V();if(t.maybeNeedScrollParent=!1,this.startPointDom.style.backgroundColor="#E0E0E0",this.path.remove(),this.isEditLine&&(this.tempTagDom.remove(),this.tempTagDom=null),!this.endNode)this.isEditLine&&(this.curLine.hidden=!1);else if(this.isEditLine){const o=this.flowData.connections,e=o.findIndex(l=>l.id===this.curLine.id);o.splice(e,1),this.dialogState.data.type=this.curLine.type,this.add()}else ie.includes(this.startNode.type)?(this.getLinkTypeOp(this.startNode),this.dialogState.visible=!0,this.isEditTag=!1):(this.dialogState.data.type="TRUE",this.add())});u(this,"add",()=>{this.flowData.connections.push({fromId:this.startNode.id,toId:this.endNode.id,type:this.dialogState.data.type,id:Ne()})});u(this,"getLinkTypeOp",t=>{ie.includes(t.type)?this.dialogState.linkOp=Ie:this.dialogState.linkOp=ue});this.flowSvgRef=t,this.flowDomOffset=o,this.flowData=e,this.flowRef=l,Z(F,"mouseMove",this.mouseMove),Z(F,"mouseUp",this.mouseUp)}}class Bt{constructor(t){u(this,"flowRef");u(this,"edge",{top:0,left:0,bottom:0,right:0});u(this,"delta",10);u(this,"mouseMove",t=>{if(!V().maybeNeedScrollParent)return;const e=this.flowRef.value.parentElement,l=this.delta;t.x>this.edge.right?e.scrollLeft+=l:t.x<this.edge.left&&(e.scrollLeft-=l),t.y>this.edge.bottom?e.scrollTop+=l:t.y<this.edge.top&&(e.scrollTop-=l)});u(this,"getEdge",()=>{const t=Number.parseInt(getComputedStyle(document.documentElement).fontSize);this.edge.bottom=window.innerHeight-.5*t-20,this.edge.right=window.innerWidth-.5*t-20;const{x:o,y:e}=this.flowRef.value.getBoundingClientRect();this.edge.top=e+50,this.edge.left=o+50});this.flowRef=t,Z(F,"mouseMove",this.mouseMove)}}class zt{constructor(t,o){u(this,"visible",j(!1));u(this,"selectRect",{x1:0,y1:0,x2:0,y2:0});u(this,"selectElement");u(this,"flowData");u(this,"mouseDown",t=>{this.visible.value=!0;const o=this.getRelativePos(t);this.selectRect.x1=o.x,this.selectRect.y1=o.y,this.selectRect.x2=this.selectRect.x1,this.selectRect.y2=this.selectRect.y1,this.updateSelectRect();const e=V();e.maybeNeedScrollParent=!0});u(this,"mouseMove",t=>{if(!this.visible.value)return;const o=this.getRelativePos(t);this.selectRect.x2=o.x,this.selectRect.y2=o.y,this.updateSelectRect()});u(this,"mouseUp",t=>{if(!this.visible.value)return;this.visible.value=!1;const o=V();o.maybeNeedScrollParent=!1,this.selectElementNode()});u(this,"getRelativePos",t=>{const o=V(),e=o.flowDomOffset,l=o.scrollDom;return{x:t.x-e.x+l.scrollLeft,y:t.y-e.y+l.scrollTop}});u(this,"selectElementNode",()=>{this.clear();const t=V();for(const o of this.flowData.nodes){const{layoutX:e,layoutY:l}=o.additional,{x1:s,x2:n,y1:d,y2:f}=this.selectRect,m=Math.min(s,n),r=Math.max(s,n),y=Math.min(d,f),h=Math.max(d,f);e>m&&e+J.width<r&&l>y&&l+J.height<h&&t.selectedElementNodes.push(o)}for(const o of this.flowData.connections)t.selectedElementNodes.some(e=>e.id===o.fromId)&&t.selectedLines.push(o)});u(this,"selectLine",t=>{V().selectedLines.push(t)});u(this,"clear",()=>{const t=V();t.selectedLines=[],t.selectedElementNodes=[]});this.flowData=o,this.selectElement=t,Z(F,"mouseMove",this.mouseMove),Z(F,"mouseUp",this.mouseUp)}updateSelectRect(){const t=this.selectElement.value,{x1:o,x2:e,y1:l,y2:s}=this.selectRect,n=Math.min(o,e),d=Math.max(o,e),f=Math.min(l,s),m=Math.max(l,s);t.style.left=`${n}px`,t.style.top=`${f}px`,t.style.width=`${d-n}px`,t.style.height=`${m-f}px`}}const Le=i=>(he("data-v-0dd7e4c5"),i=i(),ve(),i),Ft=["id"],Wt=Le(()=>x("polygon",{points:"-2,0 -5,5 5,0 -5,-5",stroke:"gray",fill:"gray","stroke-width":"1px"},null,-1)),Ht=[Wt],Jt=["id"],Gt=Le(()=>x("polygon",{points:"-2,0 -5,5 5,0 -5,-5",stroke:"red",fill:"red","stroke-width":"1px"},null,-1)),Qt=[Gt],Kt={class:"flex justify-center pt-12px",border:"t-1px #ccc t-solid"},Zt=I({__name:"Index",setup(i){const t=V(),o=t.flowData,e=N(),l=N(),s=N(),n=j({x:0,y:0});function d(){const{x:w,y:g}=e.value.parentElement.getBoundingClientRect();n.value.x=w,n.value.y=g,t.flowDomOffset=n.value}fe(()=>{d(),r.getEdge(),t.dom.elementNodeContainerDom=s.value,t.scrollDom=e.value.parentElement});const f=ot(()=>{d(),r.getEdge()},50);De("resize",f);const m=new qt(e);ne("dragElementNodeService",m),De("mousemove",m.onMouseMove);const r=new Bt(e),y=new Xt(n,o,e);ne("editElementNodeService",y);const h=new jt(l,n,o,e);ne("drawLineService",h);function T(w){return[...pe,...ce,...ke].find(g=>w.type===g.type).component}const E=N(),L=new zt(E,o);ne("rectangleSelect",L),Z(F,"removeElementNodes",w=>{w.forEach(g=>y.remove(g)),L.clear()});const $=N();function W(){$.value.validate(w=>{w&&(h.isEditTag?h.curLine.type=h.dialogState.data.type:h.add(),h.dialogState.visible=!1)})}return(w,g)=>{const b=U,_=O,q=M,le=A,ee=Fe,R=We;return v(),S("div",{ref_key:"flowRef",ref:e,class:"relative",style:_e({width:`${c(o).canvasSize.width}px`,height:`${c(o).canvasSize.height}px`}),onMousedown:g[6]||(g[6]=B((...D)=>c(L).mouseDown&&c(L).mouseDown(...D),["prevent"])),onMouseup:g[7]||(g[7]=(...D)=>c(m).onMouseUp&&c(m).onMouseUp(...D)),onDragover:g[8]||(g[8]=(...D)=>c(y).dragOver&&c(y).dragOver(...D)),onDrop:g[9]||(g[9]=(...D)=>c(y).add&&c(y).add(...D))},[(v(),S("svg",{id:"flowSvg",ref_key:"flowSvgRef",ref:l,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"100%",height:"100%",class:"relative z-1","data-spm-anchor-id":"TODO.11007039.0.i6.12b64a9bcbXQmm"},[x("defs",null,[x("marker",{id:c(ye),markerWidth:"5",markerHeight:"5",viewBox:"-6 -6 12 12",refX:"10",refY:"0",markerUnits:"strokeWidth",orient:"auto"},Ht,8,Ft),x("marker",{id:c(Te),markerWidth:"5",markerHeight:"5",viewBox:"-6 -6 12 12",refX:"10",refY:"0",markerUnits:"strokeWidth",orient:"auto"},Qt,8,Jt)]),x("g",null,[(v(!0),S(Q,null,K(c(o).connections,D=>(v(),P(Ct,{key:D.id,"all-data":c(o),data:D,onMousedown:g[0]||(g[0]=B(()=>{},["stop"]))},null,8,["all-data","data"]))),128))])],512)),x("div",{ref_key:"elementNodeContainerRef",ref:s,class:"absolute inset-0 select-none overflow-hidden"},[(v(!0),S(Q,null,K(c(o).nodes,D=>(v(),P(je(T(D)),{key:D.id,class:"z-2",data:D,onMousedown:g[1]||(g[1]=B(()=>{},["stop"]))},null,40,["data"]))),128)),(v(!0),S(Q,null,K(c(o).connections,D=>(v(),P(Yt,{key:D.id,"all-data":c(o),data:D,class:"z-1",onMousedown:g[2]||(g[2]=B(()=>{},["stop"]))},null,8,["all-data","data"]))),128)),x("div",{ref_key:"selectElementRef",ref:E,class:z(["absolute z-3 bg-#147dff/10",{hidden:!c(L).visible.value}]),border:"2px dashed #5262ff"},null,2)],512),a(R,{modelValue:c(h).dialogState.visible,"onUpdate:modelValue":g[5]||(g[5]=D=>c(h).dialogState.visible=D),title:"添加链接","align-center":"",width:"fit-content","destroy-on-close":""},{default:p(()=>[a(le,{ref_key:"dataFormRef",ref:$,model:c(h).dialogState.data,rules:c(h).dialogState.rules,"label-position":"right","label-width":"100px",class:"w-400px mx-50px"},{default:p(()=>[a(q,{label:"链接标签:",prop:"type"},{default:p(()=>[a(_,{modelValue:c(h).dialogState.data.type,"onUpdate:modelValue":g[3]||(g[3]=D=>c(h).dialogState.data.type=D),placeholder:"请选择"},{default:p(()=>[(v(!0),S(Q,null,K(c(h).dialogState.linkOp,(D,we)=>(v(),P(b,{key:we,label:D,value:we},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),x("div",Kt,[a(ee,{class:"w-80px",text:"",bg:"",onClick:g[4]||(g[4]=D=>c(h).dialogState.visible=!1)},{default:p(()=>[xe(" 取消")]),_:1}),a(ee,{type:"primary",class:"w-80px !ml-42px",onClick:W},{default:p(()=>[xe("确定")]),_:1})])]),_:1},8,["modelValue"])],36)}}});const eo=k(Zt,[["__scopeId","data-v-0dd7e4c5"]]);const se=i=>(he("data-v-579bac87"),i=i(),ve(),i),to={class:"relative"},oo=["onDragstart"],lo={class:"grid place-items-center w-40px bg-$event-node-color rounded-l-4px"},ao={class:"w-169px rounded-r-4px",border:"1px solid $event-node-color l-none"},no=se(()=>x("i",{class:"absolute top-1/2 right-0 -translate-y-1/2 translate-x-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),so=["onDragstart"],ro={class:"rounded-l-4px ml-7px"},io={class:"grid place-items-center w-40px rounded-r-4px"},po=se(()=>x("i",{class:"absolute top-1/2 -left-7px -translate-y-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),co=se(()=>x("i",{class:"absolute top-1/2 right-0 -translate-y-1/2 translate-x-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),uo=["onDragstart"],mo={class:"w-169px rounded-l-4px ml-7px",border:"1px solid $action-node-color r-none"},fo={class:"grid place-items-center w-40px bg-$action-node-color rounded-r-4px"},_o=se(()=>x("i",{class:"absolute top-1/2 left-0 -translate-y-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),ho=I({__name:"Left",setup(i){const t=j(["1","2","3"]),o=j(pe),e=j(ke),l=j(ce),s=j("");function n(){o.value=pe.filter(y=>y.title.toLowerCase().includes(s.value.toLowerCase())),l.value=ce.filter(y=>y.title.toLowerCase().includes(s.value.toLowerCase()))}function d(y,h){h.dataTransfer.setData("text/plain",y.type)}const f=j(!0);function m(){f.value=!f.value}function r(){const y=new Event("resize");window.dispatchEvent(y)}return(y,h)=>{const T=C,E=ae,L=He,$=Je,W=Ge,w=de("ArrowLeftBold"),g=Se,b=de("ArrowRightBold");return v(),S("div",to,[x("div",{class:z(["node-container overflow-hidden",c(f)?"w-261px":"w-0"]),onTransitionend:r},[a(T,{modelValue:c(s),"onUpdate:modelValue":h[0]||(h[0]=_=>be(s)?s.value=_:null),modelModifiers:{trim:!0},clearable:"",placeholder:"查找节点","prefix-icon":"Search",maxlength:"60",class:"mb-12px pt-26px pl-26px pr-20px",onInput:n},null,8,["modelValue"]),a(W,{"max-height":"calc(100vh - 6rem)",class:"pl-26px pr-20px"},{default:p(()=>[a($,{modelValue:c(t),"onUpdate:modelValue":h[1]||(h[1]=_=>be(t)?t.value=_:null),class:"select-none"},{default:p(()=>[a(L,{title:"事件节点",name:"1"},{default:p(()=>[(v(!0),S(Q,null,K(c(o),_=>(v(),S("div",{key:_.icon,class:"relative flex w-199px h-40px leading-40px mb-12px",text:"#333 center",draggable:"true",onDragstart:q=>d(_,q)},[x("div",lo,[a(E,{name:_.icon,class:"text-22px text-white"},null,8,["name"])]),x("div",ao,oe(_.title),1),no],40,oo))),128))]),_:1}),a(L,{title:"中间节点",name:"2"},{default:p(()=>[(v(!0),S(Q,null,K(c(e),_=>(v(),S("div",{key:_.icon,class:"relative flex justify-center w-199px h-40px leading-40px mb-12px ml-7px bg-#22d3ee rounded-4px",text:"white center",draggable:"true",onDragstart:q=>d(_,q)},[x("div",ro,oe(_.title),1),x("div",io,[a(E,{name:_.icon,class:"text-22px"},null,8,["name"])]),po,co],40,so))),128))]),_:1}),a(L,{title:"动作节点",name:"3"},{default:p(()=>[(v(!0),S(Q,null,K(c(l),_=>(v(),S("div",{key:_.icon,class:"relative flex w-199px h-40px leading-40px mb-12px",text:"#333 center",draggable:"true",onDragstart:q=>d(_,q)},[x("div",mo,oe(_.title),1),x("div",fo,[a(E,{name:_.icon,class:"text-22px text-white"},null,8,["name"])]),_o],40,uo))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})],34),x("div",{class:"absolute top-66px right-0 translate-x-full z-9 grid place-items-center w-13px h-44px rounded-r-6px bg-#D8D8D8 cursor-pointer",text:"14px white",hover:"bg-#8c8c8c",onClick:m},[c(f)?(v(),P(g,{key:0},{default:p(()=>[a(w)]),_:1})):(v(),P(g,{key:1},{default:p(()=>[a(b)]),_:1}))])])}}});const vo=k(ho,[["__scopeId","data-v-579bac87"]]),go={class:"absolute z-2 bottom-30px right-30px flex gap-x-30px",text:"38px"},yo={key:0},wo={class:"grid place-items-center w-38px h-38px rounded-1/2 bg-red cursor-pointer"},xo=I({__name:"Right",setup(i){const t=V();function o(){F.emit("removeElementNodes",t.selectedElementNodes)}return(e,l)=>{const s=ae,n=Ee;return v(),S("div",go,[a(Be,{name:"slide-up1",appear:""},{default:p(()=>[c(t).selectedElementNodes.length?(v(),S("div",yo,[a(n,{content:"删除选中节点和连接"},{default:p(()=>[x("div",wo,[a(s,{name:"delete",class:"text-20px text-white",onClick:o})])]),_:1})])):H("",!0)]),_:1})])}}});const bo=k(xo,[["__scopeId","data-v-b2f793d0"]]),Do=i=>(he("data-v-b7e7ffba"),i=i(),ve(),i),So={class:"flex h-screen"},Eo={class:"grow flex flex-col overflow-hidden"},Vo={class:"flex items-center justify-between h-50px",p:"x-25px",border:"b-1px #ccc b-solid"},No=Do(()=>x("div",{class:"font-bold tracking-3px"},"流程图绘制",-1)),To={href:"https://github.com/Fate-ui/flowChart",class:"text-black",target:"_blank"},Ro={class:"grow relative"},Po={class:"absolute inset-0 overflow-scroll ml-8px mt-8px scroller"},ko=I({__name:"Index",setup(i){const t=V(),o=localStorage.getItem("flowData");return t.flowData=o?JSON.parse(o):nt,me(t.flowData,e=>{localStorage.setItem("flowData",JSON.stringify(ze(e)))}),(e,l)=>{const s=ae,n=Ee;return v(),S("div",So,[a(vo,{class:"shrink-0",border:"r-1px r-solid #ccc"}),x("section",Eo,[x("header",Vo,[No,a(n,{content:"GitHub"},{default:p(()=>[x("a",To,[a(s,{name:"flow-list",class:"text-32px shrink-0 cursor-pointer"})])]),_:1})]),x("div",Ro,[x("div",Po,[a(eo)]),a(bo)])])])}}});const Mo=k(ko,[["__scopeId","data-v-b7e7ffba"]]);export{Mo as default};
//# sourceMappingURL=chunk-Index-d28c9b26-1700555262641.js.map
