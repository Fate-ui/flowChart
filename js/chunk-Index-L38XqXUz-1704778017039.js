var Ie=Object.defineProperty;var Ce=(i,t,o)=>t in i?Ie(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o;var c=(i,t,o)=>(Ce(i,typeof t!="symbol"?t+"":t,o),o);import{d as Me,_ as le,a as P}from"./index.js";import{g as Ue,b as Oe,u,w as me,B as $,y as N,t as te,E as Ye,e as fe,p as J,r as j,ac as re,o as v,c as S,a as b,_ as z,V as H,J as B,L as l,P as p,S as oe,C as Xe,R as he,U as k,q as Ae,H as qe,A as ne,M as Q,ae as K,T as be,Q as je,an as _e,ao as ve,v as xe,$ as ze,a9 as Be}from"./chunk-vue-1fs7Sq3s-1704778017039.js";import{E as Se,f as C,g as M,h as U,j as O,k as Y,l as Fe,m as We,n as He,o as Ge,p as Je,q as Ve}from"./chunk-element-plus--2ZWt5il-1704778017039.js";function Ee(i){return Ue()?(Oe(i),!0):!1}function ge(i){return typeof i=="function"?i():u(i)}const Qe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ke=Object.prototype.toString,Ze=i=>Ke.call(i)==="[object Object]",de=()=>{};function et(i,t){function o(...e){return new Promise((a,s)=>{Promise.resolve(i(()=>t.apply(this,e),{fn:t,thisArg:this,args:e})).then(a).catch(s)})}return o}function tt(i,t=!0,o=!0,e=!1){let a=0,s,n=!0,r=de,f;const m=()=>{s&&(clearTimeout(s),s=void 0,r(),r=de)};return y=>{const _=ge(i),T=Date.now()-a,V=()=>f=y();return m(),_<=0?(a=Date.now(),V()):(T>_&&(o||!n)?(a=Date.now(),V()):t&&(f=new Promise((L,I)=>{r=e?I:L,s=setTimeout(()=>{a=Date.now(),n=!0,L(V()),m()},Math.max(0,_-T))})),!o&&!s&&(s=setTimeout(()=>n=!0,_)),n=!1,f)}}function ot(i,t=200,o=!1,e=!0,a=!1){return et(tt(t,o,e,a),i)}function at(i){var t;const o=ge(i);return(t=o==null?void 0:o.$el)!=null?t:o}const lt=Qe?window:void 0;function De(...i){let t,o,e,a;if(typeof i[0]=="string"||Array.isArray(i[0])?([o,e,a]=i,t=lt):[t,o,e,a]=i,!t)return de;Array.isArray(o)||(o=[o]),Array.isArray(e)||(e=[e]);const s=[],n=()=>{s.forEach(d=>d()),s.length=0},r=(d,y,_,T)=>(d.addEventListener(y,_,T),()=>d.removeEventListener(y,_,T)),f=me(()=>[at(t),ge(a)],([d,y])=>{if(n(),!d)return;const _=Ze(y)?{...y}:y;s.push(...o.flatMap(T=>e.map(V=>r(d,T,V,_))))},{immediate:!0,flush:"post"}),m=()=>{f(),n()};return Ee(m),m}const nt={canvasSize:{width:1920,height:1080},nodes:[{id:"b8311a00-7202-445d-8758-6a60df5403a3",type:"middleNode2",params:{},additional:{layoutX:450,layoutY:293,showDrop:!1}},{id:"8eae56e7-6f42-441e-87e5-ff9731fd94cb",type:"actionNode1",params:{name:"test",eventType:2},additional:{layoutX:770,layoutY:444,showDrop:!0}},{id:"6bba2281-d768-4b54-9010-954ab077ba55",type:"eventNode1",params:{},additional:{layoutX:35,layoutY:161,showDrop:!1}}],connections:[{fromId:"6bba2281-d768-4b54-9010-954ab077ba55",toId:"b8311a00-7202-445d-8758-6a60df5403a3",type:"SECOND",id:"1f1a741c-9236-4883-89f4-38b1b226f208"},{fromId:"b8311a00-7202-445d-8758-6a60df5403a3",toId:"8eae56e7-6f42-441e-87e5-ff9731fd94cb",type:"TRUE",id:"96e4e78e-64dc-497d-8b3d-6465653dc376"}]},E=Me({id:"flow",state:()=>({maybeNeedScrollParent:!1,dom:{elementNodeContainerDom:null},flowData:{canvasSize:{width:1920,height:1080},nodes:[],connections:[]},flowDomOffset:null,scrollDom:null,selectedLines:[],selectedElementNodes:[],hoverLine:null,validateResults:[]}),actions:{}});function st(i){return{all:i=i||new Map,on:function(t,o){var e=i.get(t);e?e.push(o):i.set(t,[o])},off:function(t,o){var e=i.get(t);e&&(o?e.splice(e.indexOf(o)>>>0,1):i.set(t,[]))},emit:function(t,o){var e=i.get(t);e&&e.slice().map(function(a){a(o)}),(e=i.get("*"))&&e.slice().map(function(a){a(t,o)})}}}const F=st();function Ne(){const i=[],t="0123456789abcdef";for(let e=0;e<36;e++)i[e]=t.at(Math.floor(Math.random()*16));return i[14]="4",i[19]=t.at(i[19]&3|8),i[8]=i[13]=i[18]=i[23]="-",i.join("")}function Z(i,t,o){function e(r){if(!r.on||typeof r.on!="function"){console.warn(`${r}上不存在on方法`);return}if(!r.off||typeof r.off!="function"){console.warn(`${r}上不存在off方法`);return}}let a=()=>{};const s=me(()=>u(i),r=>{a(),e(r),r.on(t,o),a=()=>{r.off(t,o),a=()=>{}}},{immediate:!0,flush:"post"}),n=()=>{s(),a()};return Ee(n),n}const rt={class:"flex items-center h-40Px w-full"},dt=$({__name:"Index",props:{data:{},title:{},controlPoint:{},formRef:{}},setup(i){var w,g;const{data:t,title:o,controlPoint:e,formRef:a}=i,s=N(),n=te("dragElementNodeService"),r=te("drawLineService"),f=te("editElementNodeService");(g=(w=t.additional).showDrop)!=null||(w.showDrop=!0);const m=Ye(t.additional,"showDrop"),d=N();fe(()=>{const{height:x}=d.value.firstElementChild.getBoundingClientRect();d.value.style.setProperty("--height",`${x}px`),V.value=!m.value});const y=E(),_=J(()=>y.selectedElementNodes.some(x=>x.id===t.id));function T(){m.value=!m.value,m.value&&(V.value=!1)}const V=j(!1);function L(){V.value=!m.value}const I=j(!0);return Z(F,"validate",()=>{a&&a.validate(x=>{I.value=x,y.validateResults.push(x)})}),(x,h)=>{const q=re("ArrowDown"),ae=Se,ee=le;return v(),S("div",{ref_key:"nodeRef",ref:s,style:he({transform:`translate(${x.data.additional.layoutX}px, ${x.data.additional.layoutY}px)`}),class:B(["element-node absolute flex flex-col items-center w-280Px rounded-6Px",{selected:u(_),"validate-fail":!u(I)}]),onMousedown:h[9]||(h[9]=R=>u(n).onMouseDown(x.data,R,u(s)))},[b("header",rt,[x.controlPoint!=="right"?(v(),S("i",{key:0,class:"extend-area !absolute w-14Px h-14Px inline-block rounded-3Px cursor-pointer bg-#e0e0e0 -translate-x-1/2",border:"1Px solid #999",onMousedown:h[0]||(h[0]=z(R=>u(r).mouseDown("left",x.data,R),["stop"])),onMouseenter:h[1]||(h[1]=R=>u(r).mouseEnterConnector("left",x.data,R)),onMouseleave:h[2]||(h[2]=(...R)=>u(r).mouseLeaveConnector&&u(r).mouseLeaveConnector(...R))},null,32)):H("",!0),b("div",{class:B(["header-bar w-full flex items-center justify-between h-full rounded-t-6Px",{"rounded-b-6Px":u(V)}]),p:"x-20Px",text:"14Px center white"},[l(ae,{class:"cursor-pointer",onClick:z(T,["prevent"]),onMousedown:h[3]||(h[3]=z(R=>u(n).setIndex(u(s)),["stop"]))},{default:p(()=>[l(q,{class:B(["arrow",{"-rotate-180":!u(m)}])},null,8,["class"])]),_:1},8,["onClick"]),b("span",null,oe(x.title),1),l(ee,{name:"close",class:"text-17Px cursor-pointer",onClick:h[4]||(h[4]=R=>u(f).remove(x.data)),onMousedown:h[5]||(h[5]=z(()=>{},["stop"]))})],2),x.controlPoint!=="left"?(v(),S("i",{key:1,class:"extend-area !absolute right-0 w-14Px h-14Px inline-block rounded-3Px cursor-pointer bg-#e0e0e0 translate-x-1/2",border:"1Px solid #999",onMousedown:h[6]||(h[6]=z(R=>u(r).mouseDown("right",x.data,R),["stop"])),onMouseenter:h[7]||(h[7]=R=>u(r).mouseEnterConnector("right",x.data,R)),onMouseleave:h[8]||(h[8]=(...R)=>u(r).mouseLeaveConnector&&u(r).mouseLeaveConnector(...R))},null,32)):H("",!0)]),b("footer",{ref_key:"dropRef",ref:d,class:B(["drop-content w-full overflow-hidden rounded-b-6Px",u(m)?"h-drop":"!h-0"]),onTransitionend:L},[Xe(x.$slots,"default",{},void 0,!0)],34)],38)}}}),A=P(dt,[["__scopeId","data-v-97ffde04"]]),it=$({__name:"Event2",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"事件节点2","control-point":"right","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),pt=P(it,[["__scopeId","data-v-91d33750"]]),ut=$({__name:"Evnet3",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"条件节点3","control-point":"right","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),ct=P(ut,[["__scopeId","data-v-561304a9"]]),mt=$({__name:"Event4",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"事件节点4","control-point":"right","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),ft=P(mt,[["__scopeId","data-v-7a19bc5f"]]),ht=$({__name:"Event5",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"事件节点5","control-point":"right","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),_t=P(ht,[["__scopeId","data-v-613a4253"]]),vt=$({__name:"Event1",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"条件节点1","control-point":"right","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),gt=P(vt,[["__scopeId","data-v-56ca2715"]]),yt=$({__name:"Middle1",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"中间节点1","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),wt=P(yt,[["__scopeId","data-v-c09fc3d1"]]),bt=$({__name:"Middle2",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"中间节点2","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),xt=P(bt,[["__scopeId","data-v-b403c414"]]),Dt=$({__name:"Action2",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"动作节点2","control-point":"left","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),St=P(Dt,[["__scopeId","data-v-cf742146"]]),Vt=$({__name:"Action1",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"动作节点1","control-point":"left","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),Et=P(Vt,[["__scopeId","data-v-9ed96ce1"]]),Nt=$({__name:"Action3",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"动作节点3","control-point":"left","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),Tt=P(Nt,[["__scopeId","data-v-735a9f0b"]]),Rt=$({__name:"Action4",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"动作节点4","control-point":"left","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),kt=P(Rt,[["__scopeId","data-v-d0a5538e"]]),Pt=$({__name:"Action5",props:{data:{}},setup(i){const t=N(),o={eventType:[{required:!0,message:"请选择",trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}]};return(e,a)=>{const s=C,n=M,r=U,f=O,m=Y;return v(),k(A,{data:e.data,title:"动作节点5","control-point":"left","form-ref":u(t)},{default:p(()=>[l(m,{ref_key:"formRef",ref:t,inline:!0,model:e.data.params,rules:o,class:"bg-#fff py-14px px-20Px h-154Px flex flex-col justify-around","label-width":76,"label-position":"left"},{default:p(()=>[l(n,{label:"字段1",prop:"name"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[0]||(a[0]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(n,{label:"字段2",prop:"eventType"},{default:p(()=>[l(f,{modelValue:e.data.params.eventType,"onUpdate:modelValue":a[1]||(a[1]=d=>e.data.params.eventType=d),placeholder:"请选择类型","popper-class":"select-pop"},{default:p(()=>[l(r,{label:"类型1",value:1}),l(r,{label:"类型2",value:2}),l(r,{label:"类型3",value:3})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字段3"},{default:p(()=>[l(s,{modelValue:e.data.params.name,"onUpdate:modelValue":a[2]||(a[2]=d=>e.data.params.name=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["data","form-ref"])}}}),$t=P(Pt,[["__scopeId","data-v-0d4217f1"]]),G={width:280,height:40},ye=`arrow${Math.random()*100}`,Te=`${ye}-selected`,Re="control-btn",X={fromX:G.width,fromY:G.height/2,toX:0,toY:G.height/2};function ke(i,t){return`M ${i.x} ${i.y}  C ${i.x}, ${i.y+(t.y-i.y)/2} ${t.x-50}, ${t.y-(t.y-i.y)/2} ${t.x} ${t.y}`}const ie=["eventNode1","eventNode3","middleNode1"],pe=[{icon:"event-1",title:"条件节点1",type:"eventNode1",component:gt},{icon:"event-2",title:"事件节点2",type:"eventNode2",component:pt},{icon:"event-3",title:"条件节点3",type:"eventNode3",component:ct},{icon:"event-4",title:"事件节点4",type:"eventNode4",component:ft},{icon:"event-5",title:"事件节点5",type:"eventNode5",component:_t}],Pe=[{icon:"middle-1",title:"条件节点1",type:"middleNode1",component:wt},{icon:"middle-2",title:"中间节点2",type:"middleNode2",component:xt}],ue=[{icon:"action-1",title:"动作节点1",type:"actionNode1",component:Et},{icon:"action-2",title:"动作节点2",type:"actionNode2",component:St},{icon:"action-3",title:"动作节点3",type:"actionNode3",component:Tt},{icon:"action-4",title:"动作节点4",type:"actionNode4",component:kt},{icon:"action-5",title:"动作节点5",type:"actionNode5",component:$t}],ce={TRUE:"满足",FALSE:"不满足"},$e={FIRST:"条件一",SECOND:"条件二",THIRD:"条件三"},Lt=["d","marker-end","onClick"],It=$({__name:"ConnectLine",props:{allData:{},data:{}},setup(i){const{allData:t,data:o}=i,e=j();Ae(()=>{if(!t)return;const{fromId:y,toId:_}=o,T=t.nodes.find(g=>g.id===y),V=t.nodes.find(g=>g.id===_);if(!T||!V)return;const L=T.additional.layoutX+X.fromX,I=T.additional.layoutY+X.fromY,W=V.additional.layoutX+X.toX,w=V.additional.layoutY+X.toY;e.value=ke({x:L,y:I},{x:W,y:w})});const a=E(),s=te("rectangleSelect"),n=J(()=>a.selectedLines.some(y=>y.id===o.id));function r(){s.clear(),s.selectLine(o)}const f=J(()=>{var y;return!n.value&&((y=a.hoverLine)==null?void 0:y.id)===o.id});function m(){a.hoverLine=o}function d(){a.hoverLine=null}return(y,_)=>y.data.hidden?H("",!0):(v(),S("path",{key:0,d:u(e),class:B(["line",[u(n)?"selected-line":"default-line",{hover:u(f)}]]),"marker-end":`url(#${u(n)?u(Te):u(ye)})`,onClick:z(r,["stop"]),onMouseenter:m,onMouseleave:d},null,42,Lt))}}),Ct=P(It,[["__scopeId","data-v-48a84d75"]]),Mt=["id","onClick"],Ut={key:0},Ot={key:1},Yt=$({__name:"Tag",props:{allData:{},data:{}},setup(i){const{allData:t,data:o}=i,e=N();let a=80,s=40;fe(()=>{const{width:w,height:g}=e.value.getBoundingClientRect();a=w,s=g});const n=J(()=>{const{fromId:w,toId:g}=o,x=t.nodes.find(D=>D.id===w),h=t.nodes.find(D=>D.id===g);if(!x||!h)return;const q=x.additional.layoutX+X.fromX,ae=x.additional.layoutY+X.fromY,ee=h.additional.layoutX+X.toX,R=h.additional.layoutY+X.toY;return{x:(q+ee-a)/2,y:(ae+R-s)/2}}),r=E(),f=te("rectangleSelect"),m=J(()=>r.selectedLines.some(w=>w.id===o.id)),d=J(()=>{var w;return!m.value&&((w=r.hoverLine)==null?void 0:w.id)===o.id});function y(){const w=t.connections.findIndex(g=>g.id===o.id);t.connections.splice(w,1)}const _=te("drawLineService");function T(){_.dialogState.visible=!0,_.isEditTag=!0,_.dialogState.data.type=o.type,_.curLine=o,_.getLinkTypeOp(W.value)}function V(){f.clear(),f.selectLine(o)}function L(){r.hoverLine=o}function I(){r.hoverLine=null}const W=J(()=>t.nodes.find(w=>w.id===o.fromId));return(w,g)=>{const x=le;return w.data.hidden?H("",!0):(v(),S("div",{key:0,id:w.data.id,ref_key:"rectRef",ref:e,class:B(["connect-tag absolute",{hover:u(d)}]),style:he({top:`${u(n).y}px`,left:`${u(n).x}px`}),onClick:z(V,["stop"]),onMouseenter:L,onMouseleave:I},[w.data.type&&w.data.type!="TRUE"?(v(),S("div",{key:0,class:B([{selected:u(m)&&u(r).selectedElementNodes.length},"bg-white rounded-6Px"]),p:"y-7Px x-18Px",text:"12px",border:"2Px solid #ccc"},[u(ie).includes(u(W).type)?(v(),S("span",Ut,oe(u($e)[w.data.type]),1)):(v(),S("span",Ot,oe(u(ce)[w.data.type]),1))],2)):H("",!0),u(m)&&!u(r).selectedElementNodes.length?(v(),S("div",{key:1,class:B([u(Re),"absolute top-0px right-0 -translate-y-full"]),text:"24Px"},[w.data.type&&w.data.type!="TRUE"?(v(),k(x,{key:0,name:"flow-edit",class:"mr-4Px cursor-pointer",onClick:T})):H("",!0),l(x,{name:"flow-delete",class:"cursor-pointer",onClick:y})],2)):H("",!0)],46,Mt))}}}),Xt=P(Yt,[["__scopeId","data-v-1203aa96"]]);class At{constructor(t,o,e){c(this,"flowDomOffset");c(this,"flowData");c(this,"flowRef");c(this,"add",t=>{t.preventDefault();const o=t.dataTransfer.getData("text/plain"),e=this.flowRef.value.parentElement;this.flowData.nodes.push({id:Ne(),type:o,params:{},additional:{layoutX:Math.floor(t.clientX-this.flowDomOffset.value.x-G.width/2+e.scrollLeft),layoutY:Math.floor(t.clientY-this.flowDomOffset.value.y-G.height/2+e.scrollTop)}})});c(this,"remove",t=>{const o=this.flowData,e=o.nodes.findIndex(a=>a.id===t.id);for(this.flowData.nodes.splice(e,1);o.connections.some(a=>a.fromId===t.id||a.toId===t.id);){const a=o.connections.findIndex(s=>s.fromId===t.id||s.toId===t.id);o.connections.splice(a,1)}});c(this,"dragOver",t=>{t.preventDefault(),t.dataTransfer.dropEffect="link"});this.flowDomOffset=t,this.flowData=o,this.flowRef=e}}class qt{constructor(t){c(this,"curNode");c(this,"moveOffset",{x:0,y:0});c(this,"flowRef");c(this,"elementNodeDom");c(this,"preElementNodeDom");c(this,"onMouseDown",(t,o,e)=>{this.curNode=t;const{x:a,y:s}=e.getBoundingClientRect();this.moveOffset.x=o.x-a,this.moveOffset.y=o.y-s;const n=E();n.maybeNeedScrollParent=!0,this.setIndex(e)});c(this,"onMouseMove",t=>{if(F.emit("mouseMove",t),!this.curNode)return;const o=E(),e=o.scrollDom;let a=t.x-o.flowDomOffset.x-this.moveOffset.x+e.scrollLeft,s=t.y-o.flowDomOffset.y-this.moveOffset.y+e.scrollTop;a<0&&(a=0),s<0&&(s=0);let n=a-this.curNode.additional.layoutX,r=s-this.curNode.additional.layoutY;if(o.selectedElementNodes.length>1&&o.selectedElementNodes.some(f=>f.id===this.curNode.id)){const f=o.selectedElementNodes.some(d=>d.additional.layoutX+n<0),m=o.selectedElementNodes.some(d=>d.additional.layoutY+r<0);f&&(n=0),m&&(r=0),o.selectedElementNodes.forEach(d=>{d.additional.layoutX+=n,d.additional.layoutY+=r})}else this.curNode.additional.layoutX+=n,this.curNode.additional.layoutY+=r;this.extendCanvasSize({x:a,y:s})});c(this,"onMouseUp",t=>{F.emit("mouseUp",t);const o=E();o.maybeNeedScrollParent=!1,this.curNode=null,this.setPreDom()});c(this,"setIndex",t=>{this.preElementNodeDom&&(this.preElementNodeDom.style.zIndex="2"),this.elementNodeDom=t,t.style.zIndex="3"});c(this,"setPreDom",()=>{this.preElementNodeDom=this.elementNodeDom});c(this,"extendCanvasSize",t=>{const{width:o,height:e}=this.flowRef.value.getBoundingClientRect(),a=E();t.x>o-G.width&&(a.flowData.canvasSize.width+=500),t.y>e&&(a.flowData.canvasSize.height+=500)});this.flowRef=t}}class jt{constructor(t,o,e,a){c(this,"isDrawing",!1);c(this,"startPointDom");c(this,"startPos",{x:0,y:0});c(this,"startPointType","");c(this,"startNode");c(this,"endNode",null);c(this,"isEditLine",!1);c(this,"isEditTag",!1);c(this,"curLine");c(this,"path");c(this,"flowSvgRef");c(this,"flowDomOffset");c(this,"flowData");c(this,"flowRef");c(this,"dialogState",qe({visible:!1,rules:{type:[{required:!0,message:"请选择类型",trigger:"blur"}]},data:{type:null},linkOp:ce}));c(this,"tempTagDom");c(this,"mouseDown",(t,o,e)=>{this.endNode=null,this.startPointDom=e.target,this.startPointDom.style.backgroundColor="#999999",this.isDrawing=!0,this.dialogState.data.type=null;const a=E();a.maybeNeedScrollParent=!0,this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.setAttribute("stroke","#808080"),this.path.setAttribute("stroke-width","4"),this.path.setAttribute("fill","transparent"),this.flowSvgRef.value.append(this.path);const s=this.flowRef.value.parentElement;if(t==="left"){const f=this.flowData.connections.filter(m=>m.toId===o.id);if(f.length){const m=f[Math.floor(Math.random()*f.length)];this.editLine(m);return}}this.isEditLine=!1,this.startNode=o,this.startPointType=t;const{x:n,y:r}=this.startPointDom.getBoundingClientRect();this.startPos.x=n+s.scrollLeft,this.startPos.y=r+s.scrollTop});c(this,"editLine",t=>{this.startPointType="right",this.isEditLine=!0,this.curLine=t,this.cancelSelect(t),this.addTempTag(t),this.startNode=this.flowData.nodes.find(e=>e.id===t.fromId),this.startPos.x=this.startNode.additional.layoutX+X.fromX+this.flowDomOffset.value.x,this.startPos.y=this.startNode.additional.layoutY+X.fromY+this.flowDomOffset.value.y;const o=this.flowData.nodes.find(e=>e.id===t.toId);this.setPath({x:o.additional.layoutX+this.flowDomOffset.value.x,y:o.additional.layoutY+X.fromY+this.flowDomOffset.value.y}),t.hidden=!0});c(this,"cancelSelect",t=>{const e=E().selectedLines,a=e.findIndex(s=>s.id===t.id);a>-1&&e.splice(a,1)});c(this,"addTempTag",t=>{var n;(n=this.tempTagDom)==null||n.remove();const e=document.getElementById(t.id).cloneNode(!0),a=e.querySelector(`.${Re}`);a==null||a.remove(),e.id="tempTagDom",E().dom.elementNodeContainerDom.append(e),this.tempTagDom=e});c(this,"mouseMove",t=>{if(!this.isDrawing||this.endNode)return;const o=this.flowRef.value.parentElement,e={x:t.x+o.scrollLeft,y:t.y+o.scrollTop},a=this.setPath(e);this.isEditLine&&this.setTagPosition(a.from,a.to)});c(this,"setPath",t=>{const o=this.flowDomOffset,e=this.startPos.x-o.value.x,a=this.startPos.y-o.value.y;let s=t.x-o.value.x,n=t.y-o.value.y;s<0&&(s=0),n<0&&(n=0);const r=ke({x:e,y:a},{x:s,y:n});return this.path.setAttribute("d",r),{from:{x:e,y:a},to:{x:s,y:n}}});c(this,"setTagPosition",(t,o)=>{const{width:e,height:a}=this.tempTagDom.getBoundingClientRect();this.tempTagDom.style.left=`${(t.x+o.x-e)/2}px`,this.tempTagDom.style.top=`${(t.y+o.y-a)/2}px`});c(this,"mouseEnterConnector",(t,o,e)=>{!this.isDrawing||this.startPointType=="left"||t===this.startPointType||this.startNode.id===o.id||this.flowData.connections.some(s=>[s.fromId,s.toId].every(n=>[this.startNode.id,o.id].includes(n)))||(this.endNode=o,this.setPath({x:o.additional.layoutX+this.flowDomOffset.value.x,y:o.additional.layoutY+X.fromY+this.flowDomOffset.value.y}))});c(this,"mouseLeaveConnector",()=>{this.dialogState.visible||(this.endNode=null)});c(this,"mouseUp",()=>{if(!this.isDrawing)return;this.isDrawing=!1;const t=E();if(t.maybeNeedScrollParent=!1,this.startPointDom.style.backgroundColor="#E0E0E0",this.path.remove(),this.isEditLine&&(this.tempTagDom.remove(),this.tempTagDom=null),!this.endNode)this.isEditLine&&(this.curLine.hidden=!1);else if(this.isEditLine){const o=this.flowData.connections,e=o.findIndex(a=>a.id===this.curLine.id);o.splice(e,1),this.dialogState.data.type=this.curLine.type,this.add()}else ie.includes(this.startNode.type)?(this.getLinkTypeOp(this.startNode),this.dialogState.visible=!0,this.isEditTag=!1):(this.dialogState.data.type="TRUE",this.add())});c(this,"add",()=>{this.flowData.connections.push({fromId:this.startNode.id,toId:this.endNode.id,type:this.dialogState.data.type,id:Ne()})});c(this,"getLinkTypeOp",t=>{ie.includes(t.type)?this.dialogState.linkOp=$e:this.dialogState.linkOp=ce});this.flowSvgRef=t,this.flowDomOffset=o,this.flowData=e,this.flowRef=a,Z(F,"mouseMove",this.mouseMove),Z(F,"mouseUp",this.mouseUp)}}class zt{constructor(t){c(this,"flowRef");c(this,"edge",{top:0,left:0,bottom:0,right:0});c(this,"delta",10);c(this,"mouseMove",t=>{if(!E().maybeNeedScrollParent)return;const e=this.flowRef.value.parentElement,a=this.delta;t.x>this.edge.right?e.scrollLeft+=a:t.x<this.edge.left&&(e.scrollLeft-=a),t.y>this.edge.bottom?e.scrollTop+=a:t.y<this.edge.top&&(e.scrollTop-=a)});c(this,"getEdge",()=>{const t=Number.parseInt(getComputedStyle(document.documentElement).fontSize);this.edge.bottom=window.innerHeight-.5*t-20,this.edge.right=window.innerWidth-.5*t-20;const{x:o,y:e}=this.flowRef.value.getBoundingClientRect();this.edge.top=e+50,this.edge.left=o+50});this.flowRef=t,Z(F,"mouseMove",this.mouseMove)}}class Bt{constructor(t,o){c(this,"visible",j(!1));c(this,"selectRect",{x1:0,y1:0,x2:0,y2:0});c(this,"selectElement");c(this,"flowData");c(this,"mouseDown",t=>{this.visible.value=!0;const o=this.getRelativePos(t);this.selectRect.x1=o.x,this.selectRect.y1=o.y,this.selectRect.x2=this.selectRect.x1,this.selectRect.y2=this.selectRect.y1,this.updateSelectRect();const e=E();e.maybeNeedScrollParent=!0});c(this,"mouseMove",t=>{if(!this.visible.value)return;const o=this.getRelativePos(t);this.selectRect.x2=o.x,this.selectRect.y2=o.y,this.updateSelectRect()});c(this,"mouseUp",t=>{if(!this.visible.value)return;this.visible.value=!1;const o=E();o.maybeNeedScrollParent=!1,this.selectElementNode()});c(this,"getRelativePos",t=>{const o=E(),e=o.flowDomOffset,a=o.scrollDom;return{x:t.x-e.x+a.scrollLeft,y:t.y-e.y+a.scrollTop}});c(this,"selectElementNode",()=>{this.clear();const t=E();for(const o of this.flowData.nodes){const{layoutX:e,layoutY:a}=o.additional,{x1:s,x2:n,y1:r,y2:f}=this.selectRect,m=Math.min(s,n),d=Math.max(s,n),y=Math.min(r,f),_=Math.max(r,f);e>m&&e+G.width<d&&a>y&&a+G.height<_&&t.selectedElementNodes.push(o)}for(const o of this.flowData.connections)t.selectedElementNodes.some(e=>e.id===o.fromId)&&t.selectedLines.push(o)});c(this,"selectLine",t=>{E().selectedLines.push(t)});c(this,"clear",()=>{const t=E();t.selectedLines=[],t.selectedElementNodes=[]});this.flowData=o,this.selectElement=t,Z(F,"mouseMove",this.mouseMove),Z(F,"mouseUp",this.mouseUp)}updateSelectRect(){const t=this.selectElement.value,{x1:o,x2:e,y1:a,y2:s}=this.selectRect,n=Math.min(o,e),r=Math.max(o,e),f=Math.min(a,s),m=Math.max(a,s);t.style.left=`${n}px`,t.style.top=`${f}px`,t.style.width=`${r-n}px`,t.style.height=`${m-f}px`}}const Le=i=>(_e("data-v-0dd7e4c5"),i=i(),ve(),i),Ft=["id"],Wt=Le(()=>b("polygon",{points:"-2,0 -5,5 5,0 -5,-5",stroke:"gray",fill:"gray","stroke-width":"1px"},null,-1)),Ht=[Wt],Gt=["id"],Jt=Le(()=>b("polygon",{points:"-2,0 -5,5 5,0 -5,-5",stroke:"red",fill:"red","stroke-width":"1px"},null,-1)),Qt=[Jt],Kt={class:"flex justify-center pt-12px",border:"t-1px #ccc t-solid"},Zt=$({__name:"Index",setup(i){const t=E(),o=t.flowData,e=N(),a=N(),s=N(),n=j({x:0,y:0});function r(){const{x:w,y:g}=e.value.parentElement.getBoundingClientRect();n.value.x=w,n.value.y=g,t.flowDomOffset=n.value}fe(()=>{r(),d.getEdge(),t.dom.elementNodeContainerDom=s.value,t.scrollDom=e.value.parentElement});const f=ot(()=>{r(),d.getEdge()},50);De("resize",f);const m=new qt(e);ne("dragElementNodeService",m),De("mousemove",m.onMouseMove);const d=new zt(e),y=new At(n,o,e);ne("editElementNodeService",y);const _=new jt(a,n,o,e);ne("drawLineService",_);function T(w){return[...pe,...ue,...Pe].find(g=>w.type===g.type).component}const V=N(),L=new Bt(V,o);ne("rectangleSelect",L),Z(F,"removeElementNodes",w=>{w.forEach(g=>y.remove(g)),L.clear()});const I=N();function W(){I.value.validate(w=>{w&&(_.isEditTag?_.curLine.type=_.dialogState.data.type:_.add(),_.dialogState.visible=!1)})}return(w,g)=>{const x=U,h=O,q=M,ae=Y,ee=Fe,R=We;return v(),S("div",{ref_key:"flowRef",ref:e,class:"relative",style:he({width:`${u(o).canvasSize.width}px`,height:`${u(o).canvasSize.height}px`}),onMousedown:g[6]||(g[6]=z((...D)=>u(L).mouseDown&&u(L).mouseDown(...D),["prevent"])),onMouseup:g[7]||(g[7]=(...D)=>u(m).onMouseUp&&u(m).onMouseUp(...D)),onDragover:g[8]||(g[8]=(...D)=>u(y).dragOver&&u(y).dragOver(...D)),onDrop:g[9]||(g[9]=(...D)=>u(y).add&&u(y).add(...D))},[(v(),S("svg",{id:"flowSvg",ref_key:"flowSvgRef",ref:a,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"100%",height:"100%",class:"relative z-1","data-spm-anchor-id":"TODO.11007039.0.i6.12b64a9bcbXQmm"},[b("defs",null,[b("marker",{id:u(ye),markerWidth:"5",markerHeight:"5",viewBox:"-6 -6 12 12",refX:"10",refY:"0",markerUnits:"strokeWidth",orient:"auto"},Ht,8,Ft),b("marker",{id:u(Te),markerWidth:"5",markerHeight:"5",viewBox:"-6 -6 12 12",refX:"10",refY:"0",markerUnits:"strokeWidth",orient:"auto"},Qt,8,Gt)]),b("g",null,[(v(!0),S(Q,null,K(u(o).connections,D=>(v(),k(Ct,{key:D.id,"all-data":u(o),data:D,onMousedown:g[0]||(g[0]=z(()=>{},["stop"]))},null,8,["all-data","data"]))),128))])],512)),b("div",{ref_key:"elementNodeContainerRef",ref:s,class:"absolute inset-0 select-none overflow-hidden"},[(v(!0),S(Q,null,K(u(o).nodes,D=>(v(),k(je(T(D)),{key:D.id,class:"z-2",data:D,onMousedown:g[1]||(g[1]=z(()=>{},["stop"]))},null,40,["data"]))),128)),(v(!0),S(Q,null,K(u(o).connections,D=>(v(),k(Xt,{key:D.id,"all-data":u(o),data:D,class:"z-1",onMousedown:g[2]||(g[2]=z(()=>{},["stop"]))},null,8,["all-data","data"]))),128)),b("div",{ref_key:"selectElementRef",ref:V,class:B(["absolute z-3 bg-#147dff/10",{hidden:!u(L).visible.value}]),border:"2px dashed #5262ff"},null,2)],512),l(R,{modelValue:u(_).dialogState.visible,"onUpdate:modelValue":g[5]||(g[5]=D=>u(_).dialogState.visible=D),title:"添加链接","align-center":"",width:"fit-content","destroy-on-close":""},{default:p(()=>[l(ae,{ref_key:"dataFormRef",ref:I,model:u(_).dialogState.data,rules:u(_).dialogState.rules,"label-position":"right","label-width":"100px",class:"w-400px mx-50px"},{default:p(()=>[l(q,{label:"链接标签:",prop:"type"},{default:p(()=>[l(h,{modelValue:u(_).dialogState.data.type,"onUpdate:modelValue":g[3]||(g[3]=D=>u(_).dialogState.data.type=D),placeholder:"请选择"},{default:p(()=>[(v(!0),S(Q,null,K(u(_).dialogState.linkOp,(D,we)=>(v(),k(x,{key:we,label:D,value:we},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),b("div",Kt,[l(ee,{class:"w-80px",text:"",bg:"",onClick:g[4]||(g[4]=D=>u(_).dialogState.visible=!1)},{default:p(()=>[be(" 取消")]),_:1}),l(ee,{type:"primary",class:"w-80px !ml-42px",onClick:W},{default:p(()=>[be("确定")]),_:1})])]),_:1},8,["modelValue"])],36)}}}),eo=P(Zt,[["__scopeId","data-v-0dd7e4c5"]]),se=i=>(_e("data-v-579bac87"),i=i(),ve(),i),to={class:"relative"},oo=["onDragstart"],ao={class:"grid place-items-center w-40px bg-$event-node-color rounded-l-4px"},lo={class:"w-169px rounded-r-4px",border:"1px solid $event-node-color l-none"},no=se(()=>b("i",{class:"absolute top-1/2 right-0 -translate-y-1/2 translate-x-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),so=["onDragstart"],ro={class:"rounded-l-4px ml-7px"},io={class:"grid place-items-center w-40px rounded-r-4px"},po=se(()=>b("i",{class:"absolute top-1/2 -left-7px -translate-y-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),uo=se(()=>b("i",{class:"absolute top-1/2 right-0 -translate-y-1/2 translate-x-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),co=["onDragstart"],mo={class:"w-169px rounded-l-4px ml-7px",border:"1px solid $action-node-color r-none"},fo={class:"grid place-items-center w-40px bg-$action-node-color rounded-r-4px"},ho=se(()=>b("i",{class:"absolute top-1/2 left-0 -translate-y-1/2 w-14px h-14px rounded-3px bg-#e0e0e0",border:"1px solid #999"},null,-1)),_o=$({__name:"Left",setup(i){const t=j(["1","2","3"]),o=j(pe),e=j(Pe),a=j(ue),s=j("");function n(){o.value=pe.filter(y=>y.title.toLowerCase().includes(s.value.toLowerCase())),a.value=ue.filter(y=>y.title.toLowerCase().includes(s.value.toLowerCase()))}function r(y,_){_.dataTransfer.setData("text/plain",y.type)}const f=j(!0);function m(){f.value=!f.value}function d(){const y=new Event("resize");window.dispatchEvent(y)}return(y,_)=>{const T=C,V=le,L=He,I=Ge,W=Je,w=re("ArrowLeftBold"),g=Se,x=re("ArrowRightBold");return v(),S("div",to,[b("div",{class:B(["node-container overflow-hidden",u(f)?"w-261px":"w-0"]),onTransitionend:d},[l(T,{modelValue:u(s),"onUpdate:modelValue":_[0]||(_[0]=h=>xe(s)?s.value=h:null),modelModifiers:{trim:!0},clearable:"",placeholder:"查找节点","prefix-icon":"Search",maxlength:"60",class:"mb-12px pt-26px pl-26px pr-20px",onInput:n},null,8,["modelValue"]),l(W,{"max-height":"calc(100vh - 6rem)",class:"pl-26px pr-20px"},{default:p(()=>[l(I,{modelValue:u(t),"onUpdate:modelValue":_[1]||(_[1]=h=>xe(t)?t.value=h:null),class:"select-none"},{default:p(()=>[l(L,{title:"事件节点",name:"1"},{default:p(()=>[(v(!0),S(Q,null,K(u(o),h=>(v(),S("div",{key:h.icon,class:"relative flex w-199px h-40px leading-40px mb-12px",text:"#333 center",draggable:"true",onDragstart:q=>r(h,q)},[b("div",ao,[l(V,{name:h.icon,class:"text-22px text-white"},null,8,["name"])]),b("div",lo,oe(h.title),1),no],40,oo))),128))]),_:1}),l(L,{title:"中间节点",name:"2"},{default:p(()=>[(v(!0),S(Q,null,K(u(e),h=>(v(),S("div",{key:h.icon,class:"relative flex justify-center w-199px h-40px leading-40px mb-12px ml-7px bg-#22d3ee rounded-4px",text:"white center",draggable:"true",onDragstart:q=>r(h,q)},[b("div",ro,oe(h.title),1),b("div",io,[l(V,{name:h.icon,class:"text-22px"},null,8,["name"])]),po,uo],40,so))),128))]),_:1}),l(L,{title:"动作节点",name:"3"},{default:p(()=>[(v(!0),S(Q,null,K(u(a),h=>(v(),S("div",{key:h.icon,class:"relative flex w-199px h-40px leading-40px mb-12px",text:"#333 center",draggable:"true",onDragstart:q=>r(h,q)},[b("div",mo,oe(h.title),1),b("div",fo,[l(V,{name:h.icon,class:"text-22px text-white"},null,8,["name"])]),ho],40,co))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})],34),b("div",{class:"absolute top-66px right-0 translate-x-full z-9 grid place-items-center w-13px h-44px rounded-r-6px bg-#D8D8D8 cursor-pointer",text:"14px white",hover:"bg-#8c8c8c",onClick:m},[u(f)?(v(),k(g,{key:0},{default:p(()=>[l(w)]),_:1})):(v(),k(g,{key:1},{default:p(()=>[l(x)]),_:1}))])])}}}),vo=P(_o,[["__scopeId","data-v-579bac87"]]),go={class:"absolute z-2 bottom-30px right-30px flex gap-x-30px",text:"38px"},yo={key:0},wo={class:"grid place-items-center w-38px h-38px rounded-1/2 bg-red cursor-pointer"},bo=$({__name:"Right",setup(i){const t=E();function o(){F.emit("removeElementNodes",t.selectedElementNodes)}return(e,a)=>{const s=le,n=Ve;return v(),S("div",go,[l(ze,{name:"slide-up1",appear:""},{default:p(()=>[u(t).selectedElementNodes.length?(v(),S("div",yo,[l(n,{content:"删除选中节点和连接"},{default:p(()=>[b("div",wo,[l(s,{name:"delete",class:"text-20px text-white",onClick:o})])]),_:1})])):H("",!0)]),_:1})])}}}),xo=P(bo,[["__scopeId","data-v-b2f793d0"]]),Do=i=>(_e("data-v-b7e7ffba"),i=i(),ve(),i),So={class:"flex h-screen"},Vo={class:"grow flex flex-col overflow-hidden"},Eo={class:"flex items-center justify-between h-50px",p:"x-25px",border:"b-1px #ccc b-solid"},No=Do(()=>b("div",{class:"font-bold tracking-3px"},"流程图绘制",-1)),To={href:"https://github.com/Fate-ui/flowChart",class:"text-black",target:"_blank"},Ro={class:"grow relative"},ko={class:"absolute inset-0 overflow-scroll ml-8px mt-8px scroller"},Po=$({__name:"Index",setup(i){const t=E(),o=localStorage.getItem("flowData");return t.flowData=o?JSON.parse(o):nt,me(t.flowData,e=>{localStorage.setItem("flowData",JSON.stringify(Be(e)))}),(e,a)=>{const s=le,n=Ve;return v(),S("div",So,[l(vo,{class:"shrink-0",border:"r-1px r-solid #ccc"}),b("section",Vo,[b("header",Eo,[No,l(n,{content:"GitHub"},{default:p(()=>[b("a",To,[l(s,{name:"flow-list",class:"text-32px shrink-0 cursor-pointer"})])]),_:1})]),b("div",Ro,[b("div",ko,[l(eo)]),l(xo)])])])}}}),Mo=P(Po,[["__scopeId","data-v-b7e7ffba"]]);export{Mo as default};
//# sourceMappingURL=chunk-Index-L38XqXUz-1704778017039.js.map
